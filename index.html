<!DOCTYPE html>
<html>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="John Doe">
    
    
    
    
    
    
    <title>illyasviel</title>
    <!-- inject:style -->
    <link href="/css/style.css" rel="stylesheet" type="text/css">
    <!-- endinject -->
    <style>
        .cube-loading {
            top: 0;
            position: fixed;
            width: 100%;
            height: 100%;
            background: url('/images/lg/loading.gif') no-repeat center center;
            background-color: rgba(0,0,0,.7);
        }

        .cube-loading.out {
            display: none;
        }

        .cube-loading:before {
            display: block;
            content: 'Loading';
            position: relative;
            width: 100%;
            top: 50%;
            right: -50%;
            color: #fff;
        }

        @media(max-width: 768px) {
            .cube-loading:before {
                font-size: 1.2em;
                transform: translate(-24px,20px);
                -webkit-transform: translate(-24px,20px);
                -o-transform: translate(-24px,20px);
                -ms-transform: translate(-24px,20px);
            }
        }

        @media(min-width: 768px) {
            .cube-loading:before {

            }
        }
    </style>
    
    <script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?46a930b2ba19eb51783da74a6c022015";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    

<link href="https://cdn.bootcss.com/KaTeX/0.7.1/katex.min.css" rel="stylesheet"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.0.0/styles/monokai-sublime.min.css">
<div class="cube-body">
    <nav id="cube-top-memu" class="cube-menu">
    <ul class="cube-menu-collapse">
        
        <li>
            <i class="cube-icon cube-icon-home" aria-hidden="true"></i>
            <a href="/">首页</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-archive" aria-hidden="true"></i>
            <a href="/archives">归档</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-categories" aria-hidden="true"></i>
            <a href="/categories">分类</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-tags" aria-hidden="true"></i>
            <a href="/tags">标签</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-about" aria-hidden="true"></i>
            <a href="/about-me">关于我</a>
        </li>
        
    </ul>
</nav>
<nav class="cube-side-menu" id="cube-side-menu">
    <ul class="cube-menu-list">
        
        <li>
            <a class="lrc-control">Open Lyrics</a>
        </li>
        
        <li>
            <a class="scroll-to-top">Top</a>
        </li>
    </ul>
</nav>
    <header class="cube-header" id="cube-header">
    <img src=" https://yyxxqq.github.io/picture/无标题.jpg " alt="头部背景图片">
    
    <div class="cube-type">
        <span class="cube-typed-title">星之所幸，尘之所哀。</span>
        <span class="cube-typed-cursor">|</span>
    </div>
    
</header>

    <style>
        nav.cube-menu:before {
            content: '';
            visibility: hidden;
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 44px;
        
            filter: blur(5px);
            -webkit-filter: blur(5px);
        
            z-index: -1;
            background-image: url('https://raw.githubusercontent.com/yyxxqq/yyxxqq.github.io/master/picture/back.jpg');
            background-repeat: no-repeat;
            background-position: center -206px;
            background-size: cover;
            background-color: transparent;
        }

        header.cube-background.cube-header-background {
            visibility: hidden;
            background-image: url('https://raw.githubusercontent.com/yyxxqq/yyxxqq.github.io/master/picture/back.jpg');
            background-position: center -250px;
        }
    </style>
    <header class="cube-background cube-header-background">
        
        <div class="cube-type">
            <span class="cube-typed-title">星之所幸，尘之所哀。</span>
            <span class="cube-typed-cursor">|</span>
        </div>
        
    </header>
    <div class="load-header-background"></div>
    <script>
        (function (window) {

            window.headerModule = {}
            window.headerModule.image = {
                width: '3806',
                height: '2160'
            }

        })(window)
    </script>
    
    <div class="cube-content">
        <div class="cube-left">
            
<div class="cube-excerpt" id="cube-excerpt-「雅礼集训 2017 Day2」线段游戏">
    <header class="cube-excerpt-header">
        <h1><a href="/2018/10/07/「雅礼集训-2017-Day2」线段游戏/">「雅礼集训 2017 Day2」线段游戏</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2018-10-07
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/线段树/" class="cube-excerpt-tag-link">#线段树</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="题意"><a class="markdownIt-Anchor" href="#题意"></a> 题意:</h2>
<h3 id="给出若干条线段用-x_1y_2-x_2y_2-表示其两端点坐标现在要求支持两种操作"><a class="markdownIt-Anchor" href="#给出若干条线段用-x_1y_2-x_2y_2-表示其两端点坐标现在要求支持两种操作"></a>     给出若干条线段，用 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(x_1,y_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span> , $(x_2,y_2)​ $表示其两端点坐标，现在要求支持两种操作：</h3>
<h3 id="0x_1y_1x_2y_2-表示加入一条新的线段-x_1y_2-x_2y_2"><a class="markdownIt-Anchor" href="#0x_1y_1x_2y_2-表示加入一条新的线段-x_1y_2-x_2y_2"></a>      <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">0,x_1,y_1,x_2,y_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 表示加入一条新的线段 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(x_1,y_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span> , <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(x_2,y_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>；</h3>
<h3 id="1-x_0-询问所有线段中x坐标在-x_0-处的最高点的y坐标是什么如果对应位置没有线段则输出-0"><a class="markdownIt-Anchor" href="#1-x_0-询问所有线段中x坐标在-x_0-处的最高点的y坐标是什么如果对应位置没有线段则输出-0"></a>     <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span> , <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 询问所有线段中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>坐标在 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 处的最高点的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span>坐标是什么，如果对应位置没有线段，则输出 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">0</span></span></span></span>。</h3>
<h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解:</h2>
<h3 id="线段树维护区间中位数值最大可易证最终答案一定是线段树上某个区间的最大值-注意数据中有竖线"><a class="markdownIt-Anchor" href="#线段树维护区间中位数值最大可易证最终答案一定是线段树上某个区间的最大值-注意数据中有竖线"></a>     线段树维护区间中位数值最大，可易证最终答案一定是线段树上某个区间的最大值。（注意数据中有竖线</h3>
<pre class="highlight"><code class="cpp">#include&lt;iostream&gt;
#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
#define N 1200000
#define O 320000
#define inf 10000000000
#define get(x,k,b) (x*k+b) 
using namespace std;
int n,m;
namespace seg{
	long double tk[N],tb[N],ans;
	int build(int i,int l,int r){
		tb[i]=-inf;
		if(l==r)return 0;
		int mid=(l+r)/2;
		build(i*2,l,mid);
		build(i*2+1,mid+1,r);
	}
	int insert(int i,int l,int r,long double k,long double b,int x,int y){
		if(x&lt;=l&amp;&amp;y&gt;=r){
			int mid=(l+r)/2;
			if(get(l,tk[i],tb[i])&lt;get(l,k,b)&amp;&amp;get(r,tk[i],tb[i])&lt;get(r,k,b)){
				tk[i]=k;
				tb[i]=b;
				return 0;
			}
			if(get(l,tk[i],tb[i])&gt;get(l,k,b)&amp;&amp;get(r,tk[i],tb[i])&gt;get(r,k,b))return 0;
			long double ll=get(mid,k,b);
			long double rr=get(mid,tk[i],tb[i]);
			if(ll&gt;rr){
				if(l==r)return 0;
				if(k&gt;tk[i])insert(i*2,l,mid,tk[i],tb[i],x,y);
				else insert(i*2+1,mid+1,r,tk[i],tb[i],x,y);
				tk[i]=k;
				tb[i]=b;
				return 0;
			}else{
				if(l==r)return 0;
				if(k&gt;tk[i])insert(i*2+1,mid+1,r,k,b,x,y);
				else insert(i*2,l,mid,k,b,x,y);
				return 0;
			}
			return 0;
		}
		int mid=(l+r)/2;
		if(x&lt;=mid)insert(i*2,l,mid,k,b,x,y);
		if(y&gt;mid)insert(i*2+1,mid+1,r,k,b,x,y);
	}
	int query(int i,int l,int r,int x){
		if(i==1)ans=-inf;
		ans=max(ans,get(x,tk[i],tb[i]));
		if(l==r)return 0;
		int mid=(l+r)/2;
		if(x&lt;=mid)query(i*2,l,mid,x);
		else query(i*2+1,mid+1,r,x);
	}
}
int insert(){
	int xa,ya,xb,yb;
	scanf(&quot;%d%d%d%d&quot;,&amp;xa,&amp;ya,&amp;xb,&amp;yb);
	xa++;
	xb++;
	if(xa&gt;xb){
		swap(xa,xb);
		swap(ya,yb);
	}
	long double k=(long double)(yb-ya+0.0)/(xb-xa);
	long double b=ya-k*xa;
	if(xa==xb)k=0,b=max(ya,yb);
	xa=max(1,xa);
	xa=min(xa,O);
	xb=max(1,xb);
	xb=min(xb,O);
	seg::insert(1,1,O,k,b,xa,xb);
}
int main(){
	scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
	seg::build(1,1,O);
	for(int i=1;i&lt;=n;i++)insert();
	for(int i=1;i&lt;=m;i++){
		int type;
		scanf(&quot;%d&quot;,&amp;type);
		if(type==0)insert();
		if(type==1){
			int x;
			scanf(&quot;%d&quot;,&amp;x);
			x++;
			seg::query(1,1,O,x);
			if(seg::ans&lt;=-inf+1){
				printf(&quot;0.0000000\n&quot;);
				continue;
			}
			printf(&quot;%5Lf\n&quot;,seg::ans);
		}
	}
} 
</code></pre>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2018/10/07/「雅礼集训-2017-Day2」线段游戏/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-K相等">
    <header class="cube-excerpt-header">
        <h1><a href="/2018/10/07/K相等/">K相等</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2018-10-07
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/好题/" class="cube-excerpt-tag-link">#好题</a>
                
                <a href="/tags/人类智慧/" class="cube-excerpt-tag-link">#人类智慧</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="题目img"><a class="markdownIt-Anchor" href="#题目img"></a> 题目:<img src="http://xsy.gdgzez.com.cn/JudgeOnline/upload/attachment/image/20160113/20160113162044_49275.jpg" alt="img"></h2>
<h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解:</h2>
<h3 id="大分类讨论加上大人类智慧大概就是用人类智慧锁定哪k位不变再用人类智慧来找后继最后再上下波动搜索一下就能解决"><a class="markdownIt-Anchor" href="#大分类讨论加上大人类智慧大概就是用人类智慧锁定哪k位不变再用人类智慧来找后继最后再上下波动搜索一下就能解决"></a>     大分类讨论加上大人类智慧（大概就是用人类智慧锁定哪k位不变，再用人类智慧来找后继，最后再上下波动搜索一下就能解决。</h3>
<pre class="highlight"><code class="cpp">#include&lt;iostream&gt;
#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
using namespace std;
long long n,k,bns;
long long cal(long long x){
    long long ans=0;
    while(x){
        long long o=x%10;
        if(o==4||o==7)ans++;
        x/=10;
    }
    return ans;
}
long long check(long long x,long long y){
    for(long long i=1;i&lt;=k;i++){
        if(cal(x)!=cal(y))return 0;
        x++;
        y++;
    } 
    return 1;
}
long long Next(long long x,int p){
    long long y=x+1;
    long long o=cal(y)-cal(x)+p;
    if(x==0&amp;&amp;p!=0)return 10000;
    if(o==0)return y;
    if(o&gt;0){
        long long z=y,k=1;
        while(z){
            long long p=z%10;
            if(p!=0)
                return y+k;
            k*=10;
            z/=10;
        }
    }
    if(o&lt;0){
        int flag=0;
        if(x%10&lt;4&amp;&amp;p&lt;=-1)return x-x%10+4;
        if(x%10&lt;7&amp;&amp;p&lt;=-1)return x-x%10+7;
        if(x%10==4)return x-x%10+7;
        if(x%10==7)flag=1;
        long long Ans=Next(x/10,p-flag+1)*10+4;
        long long Bns=Next(x/10,p-flag)*10;
        if(cal(Bns)!=cal(x))return Ans;
        return min(Ans,Bns);
        return Ans;
    }
}
long long a[20];
int solve(){
    scanf(&quot;%lld%lld&quot;,&amp;n,&amp;k);
    long long m=n+k-1,l=1,L=0,c=n,flag=0,cns,o=0,O=0,f=k;
    bns=0;
    while(m&gt;0){
        long long x=n%10,y=m%10;
        if(y!=0)flag=1;
        if(x!=y){
            L=l; 
            O=o;
        }
        bns=bns+l*x;
        o++;
        a[o]=x;
        n/=10;
        m/=10;
        l*=10;
        if(l&gt;k)break;
    }
    L=max(1LL,L);
    n=c/L;
    k=(c+f-1)/L-(c)/L+1;
    if(f&lt;=10&amp;&amp;f&gt;=3&amp;&amp;(c%10==4||c%10==7)){
        k=1;
        for(int i=c-c%10+10;i&lt;=c+f;i++)if(cal(i/10)!=cal(c/10))k=2;
        n=c/10;
        O++;
    }
    long long A=0,tot=0;
    for(long long i=Next(n,0);i;i=Next(i,0)){
        tot++;
        if(check(i,n)){
            A=i;
            for(long long i=O;i&gt;=1;i--)A=A*10+a[i];
            k=f;
            for(int i=max(c+1,A-40);i&lt;=A;i++)if(k&lt;=100&amp;&amp;check(i,c)){
                printf(&quot;%lld\n&quot;,i);
                return 0;
            }
            printf(&quot;%lld\n&quot;,A);
            return 0;
        }
    }
}
int main(){
    int T;
    scanf(&quot;%d&quot;,&amp;T);
    while(T--)solve();
}
</code></pre>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2018/10/07/K相等/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-Illyasviel的图游戏">
    <header class="cube-excerpt-header">
        <h1><a href="/2018/10/05/Illyasviel的图游戏/">Illyasviel的图游戏</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2018-10-05
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/好题/" class="cube-excerpt-tag-link">#好题</a>
                
                <a href="/tags/博弈论/" class="cube-excerpt-tag-link">#博弈论</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="题意"><a class="markdownIt-Anchor" href="#题意"></a> 题意：</h2>
<h3 id="alice和bob在玩游戏"><a class="markdownIt-Anchor" href="#alice和bob在玩游戏"></a>     Alice和Bob在玩游戏。</h3>
<h3 id="他们有一张n个点m条边的带正权的简单无向图其中除了1号点和n号点每个点度数小于等于2"><a class="markdownIt-Anchor" href="#他们有一张n个点m条边的带正权的简单无向图其中除了1号点和n号点每个点度数小于等于2"></a>     他们有一张n个点m条边的带正权的简单无向图，其中除了1号点和n号点每个点度数小于等于2。</h3>
<h3 id="alice和bob轮流操作alice先手每次操作的人可以选择一条仍然存在的边并且使得边权减一-如果有一条边边权减为了零它会立即消失"><a class="markdownIt-Anchor" href="#alice和bob轮流操作alice先手每次操作的人可以选择一条仍然存在的边并且使得边权减一-如果有一条边边权减为了零它会立即消失"></a>     Alice和Bob轮流操作，Alice先手，每次操作的人可以选择一条仍然存在的边，并且使得边权减一。如果有一条边边权减为了零，它会立即消失。</h3>
<h3 id="在这张图上有一只illyasviel想要从1号点走到n号点如果在某个时刻illyasviel不能从1号点走到n号点他会十分生气并且判定上一个操作的玩家输"><a class="markdownIt-Anchor" href="#在这张图上有一只illyasviel想要从1号点走到n号点如果在某个时刻illyasviel不能从1号点走到n号点他会十分生气并且判定上一个操作的玩家输"></a>     在这张图上有一只Illyasviel想要从1号点走到n号点，如果在某个时刻Illyasviel不能从1号点走到n号点，他会十分生气并且判定上一个操作的玩家输。</h3>
<h3 id="假设alice和bob都采取最优策略请输出alice是否可以获胜是输出yes-否则输出no"><a class="markdownIt-Anchor" href="#假设alice和bob都采取最优策略请输出alice是否可以获胜是输出yes-否则输出no"></a>     假设Alice和Bob都采取最优策略，请输出Alice是否可以获胜，是输出“Yes”， 否则输出“No”</h3>
<h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解：</h2>
<h3 id="题目中对于图的限制可以看做-1-到-n-的所有简单路径互不相交-在结束游戏前的最后一步一定是剩下一条-1-到-n-的路径并且路径上的权值全都是一-如果剩下的最后一条路径确定了游戏的总步数也确定了那么先后手的胜负也确定了-那么双方的策略就使尽可能使最后留下的路径是使自己必胜的路径即尽可能切断使对方必胜的路径-切断一条路径需要的步数是这条路径上的权值的最小值-我们只需要比较双方切断对方必胜的路径所需要的步数即可-此处是官方题解"><a class="markdownIt-Anchor" href="#题目中对于图的限制可以看做-1-到-n-的所有简单路径互不相交-在结束游戏前的最后一步一定是剩下一条-1-到-n-的路径并且路径上的权值全都是一-如果剩下的最后一条路径确定了游戏的总步数也确定了那么先后手的胜负也确定了-那么双方的策略就使尽可能使最后留下的路径是使自己必胜的路径即尽可能切断使对方必胜的路径-切断一条路径需要的步数是这条路径上的权值的最小值-我们只需要比较双方切断对方必胜的路径所需要的步数即可-此处是官方题解"></a>     题目中对于图的限制可以看做 1 到 n 的所有简单路径互不相交。在结束游戏前的最后一步一定是剩下一条 1 到 n 的路径，并且路径上的权值全都是一。如果剩下的最后一条路径确定了，游戏的总步数也确定了，那么先后手的胜负也确定了。那么双方的策略就使尽可能使最后留下的路径是使自己必胜的路径，即尽可能切断使对方必胜的路径。切断一条路径需要的步数是这条路径上的权值的最小值。我们只需要比较双方切断对方必胜的路径所需要的步数即可。(此处是官方题解)</h3>
<pre class="highlight"><code class="cpp">#include&lt;iostream&gt;
#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
#define N 720000
using namespace std;
int tot,Next[N],v[N],h[N],w[N];
int n,p[N],m,bns;
long long L,R;
long long ans;
int add(int x,int y,int z){
    tot++;
    Next[tot]=h[x];
    v[tot]=y;
    w[tot]=z;
    h[x]=tot;
    return 0;
}
int dfs(int x,int a,int len){//L 奇 R 偶
    if(x==n){
        if(len&amp;1)L+=a;
        else R+=a;
        return 1;
    }
    p[x]=1;
    int flag=0;
    for(int i=h[x];i;i=Next[i]){
        if(p[v[i]]==1&amp;&amp;v[i]!=n)continue;
        dfs(v[i],min(a,w[i]),len+1);
    }
    return flag;
}
int main(){
    tot=1;
    scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
    for(int i=1;i&lt;=m;i++){
        int x,y,z;
        scanf(&quot;%d%d%d&quot;,&amp;x,&amp;y,&amp;z);
        add(x,y,z);
        add(y,x,z);
        ans+=z;
    }
    dfs(1,0x7fffffff,0);
    if((((ans-1)&amp;1)&amp;&amp;(L&gt;=R))||(((ans)&amp;1)&amp;&amp;(R&gt;=L)))printf(&quot;Yes\n&quot;);
    else printf(&quot;No\n&quot;);
}
</code></pre>
<p>题目链接:<a href="http://xsy.gdgzez.com.cn/JudgeOnline/problem.php?id=3266" target="_blank" rel="noopener">Illyasviel的图游戏</a></p>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2018/10/05/Illyasviel的图游戏/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-复活">
    <header class="cube-excerpt-header">
        <h1><a href="/2018/10/05/复活-1/">复活</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2018-10-05
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="中间因为一些奇奇怪怪的系统和奇奇怪怪的事情停更了今天又重新修好了-从今天开始复更"><a class="markdownIt-Anchor" href="#中间因为一些奇奇怪怪的系统和奇奇怪怪的事情停更了今天又重新修好了-从今天开始复更"></a>     中间因为一些奇奇怪怪的系统和奇奇怪怪的事情停更了，今天又重新修好了√。从今天开始复更。</h2>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2018/10/05/复活-1/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-2018暑假计划">
    <header class="cube-excerpt-header">
        <h1><a href="/2018/08/01/暑假计划/">2018暑假计划</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2018-08-01
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/计划表/" class="cube-excerpt-tag-link">#计划表</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="总进度300300"><a class="markdownIt-Anchor" href="#总进度300300"></a> 总进度：（300/300）</h2>
<h2 id="总错误"><a class="markdownIt-Anchor" href="#总错误"></a> 总错误：</h2>
<h3 id="mle1"><a class="markdownIt-Anchor" href="#mle1"></a>     MLE:1</h3>
<h3 id="re1"><a class="markdownIt-Anchor" href="#re1"></a>     RE:1</h3>
<h3 id="精度1"><a class="markdownIt-Anchor" href="#精度1"></a>     精度：1</h3>
<h3 id="细节错误2"><a class="markdownIt-Anchor" href="#细节错误2"></a>     细节错误：2</h3>
<h3 id="struct数组大会不稳定namespace比较稳定1"><a class="markdownIt-Anchor" href="#struct数组大会不稳定namespace比较稳定1"></a>     struct数组大会不稳定，namespace比较稳定：1</h3>
<h3 id="树的重心1"><a class="markdownIt-Anchor" href="#树的重心1"></a>     树的重心：1</h3>
<h3 id="可持久化的继承状态1"><a class="markdownIt-Anchor" href="#可持久化的继承状态1"></a>     可持久化的继承状态：1</h3>
<h2 id="2018-8-7"><a class="markdownIt-Anchor" href="#2018-8-7"></a> 2018-8-7</h2>
<h3 id="ss0100构造kmp"><a class="markdownIt-Anchor" href="#ss0100构造kmp"></a>     SS（0/100）(构造+KMP)</h3>
<h3 id="tree-game100100-博弈论"><a class="markdownIt-Anchor" href="#tree-game100100-博弈论"></a>     Tree Game（100/100） (博弈论)</h3>
<h3 id="二元运算100100分治fft"><a class="markdownIt-Anchor" href="#二元运算100100分治fft"></a>     二元运算(100/100)(分治+FFT)</h3>
<h2 id="2018-8-6"><a class="markdownIt-Anchor" href="#2018-8-6"></a> 2018-8-6</h2>
<h3 id="tree100100树形dp"><a class="markdownIt-Anchor" href="#tree100100树形dp"></a>     Tree（100/100）(树形DP)</h3>
<h3 id="异或运算100100-可持久化trie"><a class="markdownIt-Anchor" href="#异或运算100100-可持久化trie"></a>     异或运算（100/100） (可持久化trie)</h3>
<h3 id="tree-restoring10100构造"><a class="markdownIt-Anchor" href="#tree-restoring10100构造"></a>     Tree Restoring(10/100)(构造)</h3>
<h2 id="tree-restoring10100构造-2"><a class="markdownIt-Anchor" href="#tree-restoring10100构造-2"></a>     Tree Restoring(10/100)(构造)</h2>
<h2 id="2018-7-31"><a class="markdownIt-Anchor" href="#2018-7-31"></a> 2018-7-31</h2>
<h3 id="jloi2015-战争调度100100树形dp"><a class="markdownIt-Anchor" href="#jloi2015-战争调度100100树形dp"></a>     <a href="http://www.illyasviel.top/2018/08/01/JLOI2015-%E6%88%98%E4%BA%89%E8%B0%83%E5%BA%A6/" target="_blank" rel="noopener">JLOI2015 战争调度</a>(100/100)（树形DP）</h3>
<h3 id="cqoi2015-选数100100莫比乌斯反演杜教筛"><a class="markdownIt-Anchor" href="#cqoi2015-选数100100莫比乌斯反演杜教筛"></a>     <a href="http://www.illyasviel.top/2018/08/01/SCOI2015-%E9%80%89%E6%95%B0/" target="_blank" rel="noopener">CQOI2015 选数</a>(100/100)（莫比乌斯反演+杜教筛）</h3>
<h3 id="ynoi2017-由乃的oj30100树链剖分贪心场上没写完"><a class="markdownIt-Anchor" href="#ynoi2017-由乃的oj30100树链剖分贪心场上没写完"></a>     <a href="http://www.illyasviel.top/2018/08/01/YNOI2017-%E7%94%B1%E4%B9%83%E7%9A%84OJ/" target="_blank" rel="noopener">YNOI2017 由乃的OJ</a>(30/100)（树链剖分+贪心）场上没写完。</h3>
<h3 id="总体而言没有大的失误但c题没写完还是有点可惜场后不到二十分钟就a掉了"><a class="markdownIt-Anchor" href="#总体而言没有大的失误但c题没写完还是有点可惜场后不到二十分钟就a掉了"></a>     总体而言没有大的失误，但C题没写完还是有点可惜，场后不到二十分钟就A掉了。</h3>
<h2 id="2018-7-31-2"><a class="markdownIt-Anchor" href="#2018-7-31-2"></a> 2018-7-31</h2>
<h3 id="mushroom-追妹纸100100二分加hash"><a class="markdownIt-Anchor" href="#mushroom-追妹纸100100二分加hash"></a>     <a href="http://www.illyasviel.top/2018/07/31/Mushroom%E8%BF%BD%E5%A6%B9%E7%BA%B8/" target="_blank" rel="noopener">Mushroom 追妹纸</a>(100/100)（二分加hash）</h3>
<h3 id="抵制克苏恩100100概率与期望"><a class="markdownIt-Anchor" href="#抵制克苏恩100100概率与期望"></a>     <a href="http://www.illyasviel.top/2018/07/31/%E6%8A%B5%E5%88%B6%E5%85%8B%E8%8B%8F%E6%81%A9/" target="_blank" rel="noopener">抵制克苏恩</a>(100/100)（概率与期望）</h3>
<h3 id="烁烁的游戏30100可持久化线段树一开始以为是n2暴力乱搞题后面发现不对然后写可持久化线段树最后场上没写出来的原因是新增的一条链没继承之前的状态-没调出来就没敢交幸亏没交"><a class="markdownIt-Anchor" href="#烁烁的游戏30100可持久化线段树一开始以为是n2暴力乱搞题后面发现不对然后写可持久化线段树最后场上没写出来的原因是新增的一条链没继承之前的状态-没调出来就没敢交幸亏没交"></a>     <a href="http://www.illyasviel.top/2018/07/24/%E7%83%81%E7%83%81%E7%9A%84%E6%B8%B8%E6%88%8F/" target="_blank" rel="noopener">烁烁的游戏</a>(30/100)（可持久化线段树）一开始以为是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>暴力乱搞题，后面发现不对，然后写可持久化线段树（最后场上没写出来的原因是新增的一条链没继承之前的状态）。没调出来就没敢交（幸亏没交）。</h3>
<h3 id="终于又有训练赛打了"><a class="markdownIt-Anchor" href="#终于又有训练赛打了"></a>     终于又有训练赛打了。</h3>
<h2 id="2018-7-23"><a class="markdownIt-Anchor" href="#2018-7-23"></a> 2018-7-23</h2>
<h3 id="礼物100100"><a class="markdownIt-Anchor" href="#礼物100100"></a>     <a href="http://localhost:4000/2018/07/24/%E7%A4%BC%E7%89%A9/" target="_blank" rel="noopener">礼物</a>(100/100)</h3>
<h3 id="小奇的博弈20100逻辑语句写错"><a class="markdownIt-Anchor" href="#小奇的博弈20100逻辑语句写错"></a>     <a href="http://localhost:4000/2018/07/24/%E5%B0%8F%E5%A5%87%E7%9A%84%E5%8D%9A%E5%BC%88/" target="_blank" rel="noopener">小奇的博弈</a>(20/100)（逻辑语句写错）</h3>
<h3 id="烁烁的游戏10100打的就是暴力然后学了动态树分治觉得这题蛮ok"><a class="markdownIt-Anchor" href="#烁烁的游戏10100打的就是暴力然后学了动态树分治觉得这题蛮ok"></a>     <a href="http://localhost:4000/2018/07/24/%E7%83%81%E7%83%81%E7%9A%84%E6%B8%B8%E6%88%8F/" target="_blank" rel="noopener">烁烁的游戏</a>(10/100)打的就是暴力，然后学了动态树分治，觉得这题蛮ok。</h3>
<h2 id="2018-7-22"><a class="markdownIt-Anchor" href="#2018-7-22"></a> 2018-7-22</h2>
<h3 id="这场训练赛太水了全部人都ak了就不写了"><a class="markdownIt-Anchor" href="#这场训练赛太水了全部人都ak了就不写了"></a> (这场训练赛太水了，全部人都ak了，就不写了)</h3>
<h2 id="2018-7-21"><a class="markdownIt-Anchor" href="#2018-7-21"></a> 2018-7-21</h2>
<h3 id="训练赛"><a class="markdownIt-Anchor" href="#训练赛"></a> 训练赛：</h3>
<h3 id="division-expression100100"><a class="markdownIt-Anchor" href="#division-expression100100"></a>     <a href="http://www.illyasviel.top/2018/07/21/%E9%99%A4%E6%B3%95%E8%A1%A8%E8%BE%BE%E5%BC%8F/" target="_blank" rel="noopener">Division expression</a>(100/100)</h3>
<h3 id="清理雪道100100"><a class="markdownIt-Anchor" href="#清理雪道100100"></a>     <a href="http:/www.illyasviel.top/2018/07/21/%E6%B8%85%E7%90%86%E9%9B%AA%E9%81%93/" target="_blank" rel="noopener">清理雪道</a>(100/100)</h3>
<h3 id="奇数国50100发现struct开大数组会不稳定以后改用namespace"><a class="markdownIt-Anchor" href="#奇数国50100发现struct开大数组会不稳定以后改用namespace"></a>     <a href="http://www.illyasviel.top/2018/07/21/%E5%A5%87%E6%95%B0%E5%9B%BD/" target="_blank" rel="noopener">奇数国</a>(50/100)发现struct开大数组会不稳定，以后改用namespace</h3>
<h3 id="场上得分250300"><a class="markdownIt-Anchor" href="#场上得分250300"></a>     场上得分(250/300)</h3>
<h3 id="今天还去看了看前两天被卡技能树的拓展crt我还是更喜欢抽出质因子直接crt写了道模板题"><a class="markdownIt-Anchor" href="#今天还去看了看前两天被卡技能树的拓展crt我还是更喜欢抽出质因子直接crt写了道模板题"></a>     今天还去看了看前两天被卡技能树的拓展crt（我还是更喜欢抽出质因子直接crt），写了道模板题。</h3>
<h2 id="2018-7-20"><a class="markdownIt-Anchor" href="#2018-7-20"></a> 2018-7-20</h2>
<h3 id="noi网络同步赛"><a class="markdownIt-Anchor" href="#noi网络同步赛"></a> NOI网络同步赛：</h3>
<h3 id="第一题写了很久才过了大样例但因为用了set以及crt合并时三个数直接乘在一起再加上用的是lower_bound从一百崩成五十第二题没交上去-ccf的服务器是真的垃圾"><a class="markdownIt-Anchor" href="#第一题写了很久才过了大样例但因为用了set以及crt合并时三个数直接乘在一起再加上用的是lower_bound从一百崩成五十第二题没交上去-ccf的服务器是真的垃圾"></a>     第一题写了很久才过了大样例，但因为用了set以及crt合并时三个数直接乘在一起，再加上用的是lower_bound，从一百崩成五十，第二题没交上去。（CCF的服务器是真的垃圾。）</h3>
<h3 id="总观这次同步赛现在最大的问题不是我想不到而是我眼高手低手速跟不上自己的思维并且没有完全理顺就开始写以及注释加的不够导致写的过程中较为混乱场上大家都会进水只是进多少的问题了-还有就是受环境干扰太大-接下来的训练中还得加强对代码复杂度较高的题的训练并且还得再了解多一些编译原理避免系统之间的误差出错"><a class="markdownIt-Anchor" href="#总观这次同步赛现在最大的问题不是我想不到而是我眼高手低手速跟不上自己的思维并且没有完全理顺就开始写以及注释加的不够导致写的过程中较为混乱场上大家都会进水只是进多少的问题了-还有就是受环境干扰太大-接下来的训练中还得加强对代码复杂度较高的题的训练并且还得再了解多一些编译原理避免系统之间的误差出错"></a>     总观这次同步赛，现在最大的问题不是我想不到，而是我眼高手低，手速跟不上自己的思维，并且没有完全理顺就开始写，以及注释加的不够，导致写的过程中较为混乱（场上大家都会进水，只是进多少的问题了。）。还有就是受环境干扰太大。接下来的训练中还得加强对代码复杂度较高的题的训练，并且还得再了解多一些编译原理，避免系统之间的误差出错。</h3>
<h3 id="心中想到的做法是能进集训队的分打出来的是却是铜牌靠前得分-从前路一直看过来我的问题一直都不是思维不严谨也不是粗心什么的更不是运气-而是一个眼高手低的问题学东西过于偏向于理论而轻视实践-接下来的训练就是要排掉自己写的不熟的东西加快自己的写码速度"><a class="markdownIt-Anchor" href="#心中想到的做法是能进集训队的分打出来的是却是铜牌靠前得分-从前路一直看过来我的问题一直都不是思维不严谨也不是粗心什么的更不是运气-而是一个眼高手低的问题学东西过于偏向于理论而轻视实践-接下来的训练就是要排掉自己写的不熟的东西加快自己的写码速度"></a>     心中想到的做法是能进集训队的分，打出来的是却是铜牌靠前得分。从前路一直看过来，我的问题一直都不是思维不严谨，也不是粗心什么的，更不是运气。而是一个眼高手低的问题，学东西过于偏向于理论，而轻视实践。接下来的训练就是要排掉自己写的不熟的东西，加快自己的写码速度。</h3>
<h3 id="noi2018-屠龙勇士"><a class="markdownIt-Anchor" href="#noi2018-屠龙勇士"></a> <a href="http://www.illyasviel.top/2018/07/20/NOI2018-%E5%B1%A0%E9%BE%99%E5%8B%87%E5%A3%AB/" target="_blank" rel="noopener">NOI2018 屠龙勇士</a></h3>
<h2 id="2018-7-19"><a class="markdownIt-Anchor" href="#2018-7-19"></a> 2018-7-19</h2>
<h3 id="训练赛-2"><a class="markdownIt-Anchor" href="#训练赛-2"></a> 训练赛：</h3>
<h3 id="prz100100"><a class="markdownIt-Anchor" href="#prz100100"></a>     <a href="http://www.illyasviel.top/2018/07/19/%E9%9B%AA%E5%B4%A9/" target="_blank" rel="noopener">PRZ</a>(100/100)</h3>
<h3 id="race37100错因求重心时返回值出错"><a class="markdownIt-Anchor" href="#race37100错因求重心时返回值出错"></a>     <a href="http://www.illyasviel.top/2018/07/19/%E7%82%B9%E5%88%86x/" target="_blank" rel="noopener">Race</a>(37/100)错因：求重心时返回值出错</h3>
<h3 id="milk-patterns100100"><a class="markdownIt-Anchor" href="#milk-patterns100100"></a>     <a href="http://www.illyasviel.top/2018/07/19/%E5%A5%B6%E7%89%9B%E8%B4%A8%E9%87%8F/" target="_blank" rel="noopener">Milk Patterns</a>(100/100)</h3>
<h3 id="场上得分237300"><a class="markdownIt-Anchor" href="#场上得分237300"></a>     场上得分(237/300)</h3>
<h2 id="2018-7-18"><a class="markdownIt-Anchor" href="#2018-7-18"></a> 2018-7-18</h2>
<h3 id="noi网络同步赛-2"><a class="markdownIt-Anchor" href="#noi网络同步赛-2"></a> NOI网络同步赛：</h3>
<h3 id="a了一题剩下的暴力一分没拿算上送的笔试140350不过比较不擅长的字符串考完了68分送的然而最后一小时自闭了没写出来-希望后天能翻盘吧"><a class="markdownIt-Anchor" href="#a了一题剩下的暴力一分没拿算上送的笔试140350不过比较不擅长的字符串考完了68分送的然而最后一小时自闭了没写出来-希望后天能翻盘吧"></a>     A了一题，剩下的暴力一分没拿，算上送的笔试（140/350），不过比较不擅长的字符串考完了（68分送的，然而最后一小时自闭了，没写出来。）希望后天能翻盘吧。</h3>
<h3 id="noi-2018归程"><a class="markdownIt-Anchor" href="#noi-2018归程"></a> <a href="http://www.illyasviel.top/2018/07/17/NOI2018-%E5%BD%92%E7%A8%8B/" target="_blank" rel="noopener">NOI 2018归程</a></h3>
<h2 id="2018-7-17"><a class="markdownIt-Anchor" href="#2018-7-17"></a> 2018-7-17</h2>
<h3 id="训练赛-3"><a class="markdownIt-Anchor" href="#训练赛-3"></a> 训练赛：</h3>
<h3 id="find-the-outlier0100eps精度出错"><a class="markdownIt-Anchor" href="#find-the-outlier0100eps精度出错"></a>     <a href="http://www.illyasviel.top/2018/07/17/Find-the-outlier%E5%BC%82%E5%B8%B8/" target="_blank" rel="noopener">Find the outlier</a>(0/100)eps精度出错</h3>
<h3 id="征服王0100想当然地写然后思路错误"><a class="markdownIt-Anchor" href="#征服王0100想当然地写然后思路错误"></a>     <a href="http://www.illyasviel.top/2018/07/17/%E5%BE%81%E6%9C%8D%E7%8E%8B/" target="_blank" rel="noopener">征服王</a>(0/100)想当然地写然后思路错误</h3>
<h3 id="相似字串0100模板打错"><a class="markdownIt-Anchor" href="#相似字串0100模板打错"></a>     <a href="http://www.illyasviel.top/2018/07/17/%E7%9B%B8%E4%BC%BC%E5%AD%97%E4%B8%B2/" target="_blank" rel="noopener">相似字串</a>(0/100)模板打错</h3>
<h3 id="场上得分0300"><a class="markdownIt-Anchor" href="#场上得分0300"></a>     场上得分(0/300)</h3>
<h3 id="今天的情绪不是很高文化课炸了虽然早就有预计但这样下去不太行-接下来的日子里不仅是oi得搞文化课也得补了计划暑假得把理综的知识点和英语的单词语法给搞定了"><a class="markdownIt-Anchor" href="#今天的情绪不是很高文化课炸了虽然早就有预计但这样下去不太行-接下来的日子里不仅是oi得搞文化课也得补了计划暑假得把理综的知识点和英语的单词语法给搞定了"></a>     今天的情绪不是很高，文化课炸了，虽然早就有预计，但这样下去不太行。接下来的日子里不仅是OI得搞，文化课也得补了，计划暑假得把理综的知识点和英语的单词语法给搞定了。</h3>
<h3 id="在课堂上觉得十分没有效率所以索性就放弃了或许是不适应课堂的那种节奏吧-接下来全都是自学也没有什么借口能给自己找了-总之按照之前布置的作业把本该做的做了吧"><a class="markdownIt-Anchor" href="#在课堂上觉得十分没有效率所以索性就放弃了或许是不适应课堂的那种节奏吧-接下来全都是自学也没有什么借口能给自己找了-总之按照之前布置的作业把本该做的做了吧"></a>     在课堂上觉得十分没有效率，所以索性就放弃了，或许是不适应课堂的那种节奏吧。接下来全都是自学，也没有什么借口能给自己找了。总之按照之前布置的作业，把本该做的做了吧。</h3>
<h3 id="今天还爆了0真是充满负能量的一天一晚上啥也没做满脑子都是挥之不去的负面想法后路是自己断的现在想要重新准备后路的也是自己相当于是把前段时间的工作都推到了暑假策略上有点失误了-现在自己满脑子都是自己彻底失败的后果也不是太清醒明天就是网络同步赛愿能给自己前段时间的一点交代吧-我不想否定我考前一个月逃各种课写码的时间所以明天这种错误一定不能犯了啊"><a class="markdownIt-Anchor" href="#今天还爆了0真是充满负能量的一天一晚上啥也没做满脑子都是挥之不去的负面想法后路是自己断的现在想要重新准备后路的也是自己相当于是把前段时间的工作都推到了暑假策略上有点失误了-现在自己满脑子都是自己彻底失败的后果也不是太清醒明天就是网络同步赛愿能给自己前段时间的一点交代吧-我不想否定我考前一个月逃各种课写码的时间所以明天这种错误一定不能犯了啊"></a>     今天还爆了0，真是充满负能量的一天，一晚上啥也没做，满脑子都是挥之不去的负面想法，后路是自己断的，现在想要重新准备后路的也是自己，相当于是把前段时间的工作都推到了暑假，策略上有点失误了。现在自己满脑子都是自己彻底失败的后果，也不是太清醒，明天就是网络同步赛，愿能给自己前段时间的一点交代吧。我不想否定我考前一个月逃各种课写码的时间，所以明天这种错误一定不能犯了啊。</h3>
<h3 id="文化课炸了我找的借口是去搞oi了而今天oi暴零了我又想给自己找去文化课状态没回过来的借口-但这样应该是不行的啊-找再多借口也不能改变暴零的事情找再多借口也挽回不了文化课已经远远落下愿自己不再找借口别人也不再帮我找借口以后考砸了只有一个原因就是实力太垃圾"><a class="markdownIt-Anchor" href="#文化课炸了我找的借口是去搞oi了而今天oi暴零了我又想给自己找去文化课状态没回过来的借口-但这样应该是不行的啊-找再多借口也不能改变暴零的事情找再多借口也挽回不了文化课已经远远落下愿自己不再找借口别人也不再帮我找借口以后考砸了只有一个原因就是实力太垃圾"></a>     文化课炸了我找的借口是去搞OI了，而今天OI暴零了，我又想给自己找去文化课状态没回过来的借口。但这样应该是不行的啊。找再多借口也不能改变暴零的事情，找再多借口也挽回不了文化课已经远远落下，愿自己不再找借口，别人也不再帮我找借口，以后考砸了，只有一个原因，就是实力太垃圾。</h3>
<h3 id="在qq里跟父母讲了近况得到了理解和支持虽然眼前是一片迷茫但摸着黑也要走下去-我相信我的智商和付出"><a class="markdownIt-Anchor" href="#在qq里跟父母讲了近况得到了理解和支持虽然眼前是一片迷茫但摸着黑也要走下去-我相信我的智商和付出"></a>     在qq里跟父母讲了近况，得到了理解和支持，虽然眼前是一片迷茫，但摸着黑也要走下去。我相信我的智商和付出。</h3>
<h3 id="今天还刷了几题水题但都觉得没有写题解的意义不加入做题数"><a class="markdownIt-Anchor" href="#今天还刷了几题水题但都觉得没有写题解的意义不加入做题数"></a>     今天还刷了几题水题，但都觉得没有写题解的意义，不加入做题数。</h3>
<h2 id="2018-7-16"><a class="markdownIt-Anchor" href="#2018-7-16"></a> 2018-7-16</h2>
<h3 id="大包子的完美组合"><a class="markdownIt-Anchor" href="#大包子的完美组合"></a>     <a href="http://www.illyasviel.top/2018/07/16/%E5%A4%A7%E5%8C%85%E5%AD%90%E7%9A%84%E5%AE%8C%E7%BE%8E%E7%BB%84%E5%90%88/" target="_blank" rel="noopener">大包子的完美组合</a></h3>
<h3 id="等差子序列"><a class="markdownIt-Anchor" href="#等差子序列"></a>     <a href="http://www.illyasviel.top/2018/07/16/%E7%AD%89%E5%B7%AE%E5%AD%90%E5%BA%8F%E5%88%97/" target="_blank" rel="noopener">等差子序列</a></h3>
<h3 id="普通平衡树"><a class="markdownIt-Anchor" href="#普通平衡树"></a>     <a href="http://www.illyasviel.top/2018/07/16/splay%E6%9D%BF%E5%AD%90/" target="_blank" rel="noopener">普通平衡树</a></h3>
<h3 id="训练赛-4"><a class="markdownIt-Anchor" href="#训练赛-4"></a> 训练赛：</h3>
<h3 id="gcd100100"><a class="markdownIt-Anchor" href="#gcd100100"></a>     <a href="http://www.illyasviel.top/2018/07/16/%E5%BC%B1%E6%99%BA%E5%8F%8D%E6%BC%94/" target="_blank" rel="noopener">gcd</a>(100/100)</h3>
<h3 id="次小生成树-tree100100"><a class="markdownIt-Anchor" href="#次小生成树-tree100100"></a>     <a href="http://www.illyasviel.top/2018/07/16/%E6%AC%A1%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91-tree/" target="_blank" rel="noopener">次小生成树 tree</a>(100/100)</h3>
<h3 id="k个串-kstring10100失分原因nm打反导致线段树节点不够"><a class="markdownIt-Anchor" href="#k个串-kstring10100失分原因nm打反导致线段树节点不够"></a>     <a href="http://www.illyasviel.top/2018/07/16/k%E4%B8%AA%E4%B8%B2-kstring/" target="_blank" rel="noopener">k个串 kstring</a>(10/100)失分原因：NM打反导致线段树节点不够。</h3>
<h3 id="场上得分210300"><a class="markdownIt-Anchor" href="#场上得分210300"></a>     场上得分：(210/300)</h3>
<h2 id="2018-7-15"><a class="markdownIt-Anchor" href="#2018-7-15"></a> 2018-7-15</h2>
<h3 id="jsoi2008-火星人prefix"><a class="markdownIt-Anchor" href="#jsoi2008-火星人prefix"></a>     <a href="http://www.illyasviel.top/2018/07/15/%E7%81%AB%E6%98%9F%E4%BA%BA/" target="_blank" rel="noopener">JSOI2008 火星人prefix</a></h3>
<h3 id="bracket"><a class="markdownIt-Anchor" href="#bracket"></a>     <a href="http://www.illyasviel.top/2018/07/15/%E6%8B%AC%E5%8F%B7%E5%8C%B9%E9%85%8D/" target="_blank" rel="noopener">Bracket</a></h3>
<h3 id="zuma"><a class="markdownIt-Anchor" href="#zuma"></a>     <a href="http://www.illyasviel.top/2018/07/15/%E6%B6%88%E9%99%A4%E5%9B%9E%E6%96%87%E4%B8%B2/" target="_blank" rel="noopener">zuma</a></h3>
<h3 id="训练赛-5"><a class="markdownIt-Anchor" href="#训练赛-5"></a> 训练赛：</h3>
<h3 id="兔子与樱花100100"><a class="markdownIt-Anchor" href="#兔子与樱花100100"></a>     <a href="http://www.illyasviel.top/2018/07/15/%E5%85%94%E5%AD%90%E4%B8%8E%E6%A8%B1%E8%8A%B1/" target="_blank" rel="noopener">兔子与樱花</a>(100/100)</h3>
<h3 id="矩阵乘法100100"><a class="markdownIt-Anchor" href="#矩阵乘法100100"></a>     <a href="http://www.illyasviel.top/2018/07/15/%E7%9F%A9%E9%98%B5%E7%AC%ACk%E5%A4%A7/" target="_blank" rel="noopener">矩阵乘法</a>(100/100)</h3>
<h3 id="聪聪可可100100"><a class="markdownIt-Anchor" href="#聪聪可可100100"></a>     <a href="http://www.illyasviel.top/2018/07/15/%E8%81%AA%E8%81%AA%E5%8F%AF%E5%8F%AF/" target="_blank" rel="noopener">聪聪可可</a>(100/100)</h3>
<h3 id="场上得分300300"><a class="markdownIt-Anchor" href="#场上得分300300"></a>     场上得分(300/300)</h3>
<h2 id="2018-7-14"><a class="markdownIt-Anchor" href="#2018-7-14"></a> 2018-7-14</h2>
<h3 id="rank"><a class="markdownIt-Anchor" href="#rank"></a>     <a href="http://www.illyasviel.top/2018/07/14/%E6%9C%9F%E6%9C%9B%E6%8E%92%E5%90%8D/" target="_blank" rel="noopener">rank</a></h3>
<h3 id="sequence"><a class="markdownIt-Anchor" href="#sequence"></a>     <a href="http://www.illyasviel.top/2018/07/14/%E4%B8%8A%E5%8D%87%E5%AD%90%E4%B8%B2/" target="_blank" rel="noopener">sequence</a></h3>
<h3 id="string"><a class="markdownIt-Anchor" href="#string"></a>     <a href="http://www.illyasviel.top/2018/07/14/k%E9%87%8D%E5%A4%8D/" target="_blank" rel="noopener">string</a></h3>
<h3 id="训练赛-6"><a class="markdownIt-Anchor" href="#训练赛-6"></a> 训练赛：</h3>
<h3 id="game-with-probability100100"><a class="markdownIt-Anchor" href="#game-with-probability100100"></a>     <a href="http://www.illyasviel.top/2018/07/14/%E6%A6%82%E7%8E%87%E6%B8%B8%E6%88%8F/" target="_blank" rel="noopener">game with probability</a>(100/100)</h3>
<h3 id="病毒100100"><a class="markdownIt-Anchor" href="#病毒100100"></a>     <a href="http://www.illyasviel.top/2018/07/14/%E7%97%85%E6%AF%92/" target="_blank" rel="noopener">病毒</a>(100/100)</h3>
<h3 id="count-on-a-tree0100失分原因mle"><a class="markdownIt-Anchor" href="#count-on-a-tree0100失分原因mle"></a>     <a href="http://www.illyasviel.top/2018/07/14/%E6%A0%91%E4%B8%8A%E8%AE%A1%E6%95%B0/" target="_blank" rel="noopener">Count on a tree</a>(0/100)失分原因:MLE</h3>
<h3 id="场上得分200300"><a class="markdownIt-Anchor" href="#场上得分200300"></a>     场上得分(200/300)</h3>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2018/08/01/暑假计划/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-YNOI2017 由乃的OJ">
    <header class="cube-excerpt-header">
        <h1><a href="/2018/08/01/YNOI2017-由乃的OJ/">YNOI2017 由乃的OJ</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2018-08-01
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/树链剖分/" class="cube-excerpt-tag-link">#树链剖分</a>
                
                <a href="/tags/贪心/" class="cube-excerpt-tag-link">#贪心</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="题目描述"><a class="markdownIt-Anchor" href="#题目描述"></a> 题目描述:</h2>
<h3 id="noi2014起床困难综合征的树上版本"><a class="markdownIt-Anchor" href="#noi2014起床困难综合征的树上版本"></a>     NOI2014起床困难综合征的树上版本。</h3>
<h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解:</h2>
<h3 id="说实话我觉得这种直接把序列上的东西搬到树上的题很没水平-还有就是在不涉及其他的情况下卡unsigned-long-long卡了六十分这还是作为一道省选题我觉得出题人的出题水平很差劲-首先题目本身没有新意并且在不是那么重要的东西上过分追求-就只是为了卡人而出的题真的糟糕-虽然我发现了unsigned-long-long-但这种用longlong难度不会变但硬是要卡的做法我很鄙视"><a class="markdownIt-Anchor" href="#说实话我觉得这种直接把序列上的东西搬到树上的题很没水平-还有就是在不涉及其他的情况下卡unsigned-long-long卡了六十分这还是作为一道省选题我觉得出题人的出题水平很差劲-首先题目本身没有新意并且在不是那么重要的东西上过分追求-就只是为了卡人而出的题真的糟糕-虽然我发现了unsigned-long-long-但这种用longlong难度不会变但硬是要卡的做法我很鄙视"></a>     说实话我觉得这种直接把序列上的东西搬到树上的题很没水平。还有就是在不涉及其他的情况下卡unsigned long long卡了六十分，这还是作为一道省选题，我觉得出题人的出题水平很差劲。首先题目本身没有新意，并且在不是那么重要的东西上过分追求。就只是为了卡人而出的题，真的糟糕。（虽然我发现了unsigned long long 但这种用longlong难度不会变但硬是要卡的做法，我很鄙视。）</h3>
<pre class="highlight"><code class="cpp">#include&lt;iostream&gt;
#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
#define N 217000
#define ll unsigned long long
using namespace std;
int tot,Next[N],h[N],v[N],f[N][25];
ll I=1,A,B;
ll n,m,k,a[N],t[N],O;
int dep[N],siz[N],top[N],st[N],son[N],ed[N];
inline ll merge(ll x,ll A,ll B){
    ll ans=0;
    ans=(x&amp;B)|((~x)&amp;A);
    return ans;
}
inline ll cal(ll x,int type,ll y){
    if(type==1)return x&amp;y;
    if(type==2)return x|y; 
    if(type==3)return x^y;
}
namespace seg{
    ll up[N*4][2],down[N*4][2];
    int bing(int i,int x,int y){
        down[i][0]=merge(down[x][0],down[y][0],down[y][1]);
        down[i][1]=merge(down[x][1],down[y][0],down[y][1]);
        up[i][0]=merge(up[y][0],up[x][0],up[x][1]);
        up[i][1]=merge(up[y][1],up[x][0],up[x][1]);
    } 
    int build(int i,int l,int r){
        if(l==r){
            up[i][0]=cal(0,t[st[l]],a[st[l]]);
            up[i][1]=cal(O,t[st[l]],a[st[l]]);
            down[i][0]=cal(0,t[st[l]],a[st[l]]);
            down[i][1]=cal(O,t[st[l]],a[st[l]]);
            return 0;
        }
        int mid=(l+r)/2;
        build(i*2,l,mid);
        build(i*2+1,mid+1,r);
        bing(i,i*2,i*2+1);
    }
    int insert(int i,int l,int r,int x){
        if(l==r){
            up[i][0]=cal(0,t[st[l]],a[st[l]]);
            up[i][1]=cal(O,t[st[l]],a[st[l]]);
            down[i][0]=cal(0,t[st[l]],a[st[l]]);
            down[i][1]=cal(O,t[st[l]],a[st[l]]);
            return 0;
        }
        int mid=(l+r)/2;
        if(x&lt;=mid)insert(i*2,l,mid,x);
        else insert(i*2+1,mid+1,r,x);
        bing(i,i*2,i*2+1);
    }
    int query_up(int i,int l,int r,int x,int y){
        if(x&lt;=l&amp;&amp;y&gt;=r){
            A=merge(A,up[i][0],up[i][1]);
            B=merge(B,up[i][0],up[i][1]);
            return 0;
        }
        int mid=(l+r)/2;
        if(y&gt;mid)query_up(i*2+1,mid+1,r,x,y);
        if(x&lt;=mid)query_up(i*2,l,mid,x,y);
    }
    int query_down(int i,int l,int r,int x,int y){
        if(x&lt;=l&amp;&amp;y&gt;=r){
            A=merge(A,down[i][0],down[i][1]);
            B=merge(B,down[i][0],down[i][1]);
            return 0;
        }
        int mid=(l+r)/2;
        if(x&lt;=mid)query_down(i*2,l,mid,x,y);
        if(y&gt;mid)query_down(i*2+1,mid+1,r,x,y);
    }
}
int add(int x,int y){
    tot++;
    Next[tot]=h[x];
    v[tot]=y;
    h[x]=tot;
}
int dfs(int x,int fa){
    dep[x]=dep[fa]+1; 
    f[x][0]=fa;
    for(int i=1;i&lt;=17;i++)f[x][i]=f[f[x][i-1]][i-1];
    siz[x]=1;
    for(int i=h[x];i;i=Next[i]){
        if(v[i]==fa)continue;
        dfs(v[i],x);
        siz[x]+=siz[v[i]];
        if(siz[v[i]]&gt;siz[son[x]])son[x]=v[i];
    } 
}
int dfs1(int x,int fa){
    st[++tot]=x;
    ed[x]=tot;
    if(son[x]){
        top[son[x]]=top[x];
        dfs1(son[x],x);
    }
    for(int i=h[x];i;i=Next[i]){
        if(v[i]==fa)continue;
        if(v[i]==son[x])continue;
        top[v[i]]=v[i];
        dfs1(v[i],x);
    }
}
int lca(int x,int y){
    for(;top[x]!=top[y];dep[top[x]]&gt;dep[top[y]]?x=f[top[x]][0]:y=f[top[y]][0]);
    return dep[x]&lt;dep[y]?x:y;
}
int get(int x,int y){
    for(int i=17;i&gt;=0;i--)if(dep[f[y][i]]&gt;dep[x])y=f[y][i];
    return y;
}
int lfs(int x,int fa){
    if(dep[top[x]]&gt;dep[fa])lfs(f[top[x]][0],fa);
    else{
        seg::query_down(1,1,n,ed[fa],ed[x]);
        return 0;
    }
    seg::query_down(1,1,n,ed[top[x]],ed[x]);
}
int solve(int x,int y,int z){
    while(dep[top[x]]&gt;dep[z])
        seg::query_up(1,1,n,ed[top[x]],ed[x]),x=f[top[x]][0];
    seg::query_up(1,1,n,ed[z],ed[x]);
    if(z==y)return 0; 
    z=get(z,y);
    lfs(y,z);
}
int main(){
    scanf(&quot;%d%d%d&quot;,&amp;n,&amp;m,&amp;k);
    for(int i=1;i&lt;=n;i++){
        scanf(&quot;%llu%llu&quot;,&amp;t[i],&amp;a[i]);
    }
    for(int i=1;i&lt;n;i++){
        int x,y;
        scanf(&quot;%d%d&quot;,&amp;x,&amp;y);
        add(x,y);
        add(y,x);
    }
    dfs(1,0);
    tot=0;
    top[1]=1;
    dfs1(1,0);
    O=(I&lt;&lt;(k-1))-1+(I&lt;&lt;(k-1));
    seg::build(1,1,n);
    for(int i=1;i&lt;=m;i++){
        ll x,y,v;
        ll type;
        scanf(&quot;%llu&quot;,&amp;type);
        if(type==1){
            scanf(&quot;%llu%llu%llu&quot;,&amp;x,&amp;y,&amp;v);
            int z=lca(x,y);
            A=0,B=O;
            solve(x,y,z);
            ll ans=0,bns=0;
            for(int i=k-1;i&gt;=0;i--){
                ll oo=I&lt;&lt;i;
                if(A&amp;oo)bns+=oo;
                if((B&amp;oo)&amp;&amp;!(A&amp;oo)&amp;&amp;ans+oo&lt;=v)ans+=oo,bns+=oo;
            }
            printf(&quot;%llu\n&quot;,bns);
        }else{
            scanf(&quot;%llu%llu%llu&quot;,&amp;x,&amp;y,&amp;v);
            t[x]=y;
            a[x]=v;
            seg::insert(1,1,n,ed[x]);
        }
    }
}

</code></pre>
<p>题目链接: <a href="https://www.lydsy.com/JudgeOnline/problem.php?id=4811" target="_blank" rel="noopener">Ynoi2017 由乃的OJ</a></p>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2018/08/01/YNOI2017-由乃的OJ/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-CQOI2015 选数">
    <header class="cube-excerpt-header">
        <h1><a href="/2018/08/01/SCOI2015-选数/">CQOI2015 选数</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2018-08-01
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/莫比乌斯反演/" class="cube-excerpt-tag-link">#莫比乌斯反演</a>
                
                <a href="/tags/杜教筛/" class="cube-excerpt-tag-link">#杜教筛</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="题目描述"><a class="markdownIt-Anchor" href="#题目描述"></a> 题目描述:</h2>
<h3 id="我们知道从区间lhl和h为整数中选取n个整数总共有h-l1n种方案-小z很好奇这样选出的数的最大公约数的规律他决定对每种方案选出的n个整数都求一次最大公约数以便进一步研究-然而他很快发现工作量太大了于是向你寻求帮助-你的任务很简单小z会告诉你一个整数k你需要回答他最大公约数刚好为k的选取方案有多少个-由于方案数较大你只需要输出其除以1000000007的余数即可"><a class="markdownIt-Anchor" href="#我们知道从区间lhl和h为整数中选取n个整数总共有h-l1n种方案-小z很好奇这样选出的数的最大公约数的规律他决定对每种方案选出的n个整数都求一次最大公约数以便进一步研究-然而他很快发现工作量太大了于是向你寻求帮助-你的任务很简单小z会告诉你一个整数k你需要回答他最大公约数刚好为k的选取方案有多少个-由于方案数较大你只需要输出其除以1000000007的余数即可"></a>     我们知道，从区间<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mi>L</mi><mo separator="true">,</mo><mi>H</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">[L,H]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mord mathit">L</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mclose">]</span></span></span></span>(L和H为整数)中选取<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span>个整数，总共有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>H</mi><mo>−</mo><mi>L</mi><mo>+</mo><mn>1</mn><msup><mo>)</mo><mi>N</mi></msup></mrow><annotation encoding="application/x-tex">(H-L+1)^N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mbin">−</span><span class="mord mathit">L</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>种方案。小z很好奇这样选出的数的最大公约数的规律，他决定对每种方案选出的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span>个整数都求一次最大公约数，以便进一步研究。然而他很快发现工作量太大了，于是向你寻求帮助。你的任务很简单，小z会告诉你一个整数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span>，你需要回答他最大公约数刚好为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span>的选取方案有多少个。由于方案数较大，你只需要输出其除以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>0</mn><mn>0</mn><mn>0</mn><mn>0</mn><mn>0</mn><mn>0</mn><mn>0</mn><mn>7</mn></mrow><annotation encoding="application/x-tex">1000000007</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">7</span></span></span></span>的余数即可。</h3>
<h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解:</h2>
<h3 id="直接推反演式子然后杜教筛暴力堆上去即可-好像还有一种容斥做法会快一点不过限制也多一点杜教筛不用h-l的数量限制还是很优秀的"><a class="markdownIt-Anchor" href="#直接推反演式子然后杜教筛暴力堆上去即可-好像还有一种容斥做法会快一点不过限制也多一点杜教筛不用h-l的数量限制还是很优秀的"></a>     直接推反演式子然后杜教筛暴力堆上去即可。（好像还有一种容斥做法会快一点，不过限制也多一点，杜教筛不用H-L的数量限制，还是很优秀的。）</h3>
<pre class="highlight"><code class="cpp">#include&lt;iostream&gt;
#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
#include&lt;math.h&gt;
#include&lt;map&gt;
#define N 3000000
#define P 1000000007
using namespace std;
int mu[N],p[N],tot,prime[N],f[N];
map&lt;long long,int&gt;g;
long long power(long long x,int k){
    long long ans=1; 
    while(k){
        if(k&amp;1)(ans*=x)%=P;
        (x*=x)%=P;
        k&gt;&gt;=1; 
    }
    return ans;
}
int pre(){
    mu[1]=1;
    f[1]=1;
    for(int i=2;i&lt;=N-10;i++){
        if(p[i]==0)prime[++tot]=i,mu[i]=-1;
        for(int j=1;j&lt;=tot&amp;&amp;i*prime[j]&lt;=N-10;j++){
            p[i*prime[j]]=1;
            mu[i*prime[j]]=-mu[i];
            if(i%prime[j]==0){
                mu[i*prime[j]]=0;
                break;
            }
        }
        f[i]=f[i-1]+mu[i];
    }
}
long long cal(int x){
    if(x==0)return 0;
    if(x&lt;N-10)return f[x];
    if(g[x])return g[x];
    long long ans=1;
    for(long long i=2;i&lt;=x;i++){
        int j=x/(x/i);
        ans-=(j-i+1)*cal(x/i);
        i=j;
    }
    g[x]=ans;
    return ans;
}
int main(){
    pre();
    long long ans=0;
    int n,k,l,r;
    scanf(&quot;%d%d%d%d&quot;,&amp;n,&amp;k,&amp;l,&amp;r);
    l=(l-1)/k;
    r=r/k;
    int m=(r-l)+1;
    cal(l);
    cal(r);
    int j;
    for(int i=1;i&lt;=r;i++){
        if(l/i&gt;0)j=min(l/(l/i),r/(r/i));
        else j=r/(r/i); 
        (ans+=1LL*(cal(j)-cal(i-1))*power(r/i-l/i,n))%=P;
        i=j;
    }
    ans%=P;
    ans+=P;
    ans%=P;
    printf(&quot;%lld\n&quot;,ans);
}
</code></pre>
<p>题目链接:<a href="https://www.lydsy.com/JudgeOnline/problem.php?id=3930" target="_blank" rel="noopener">CQOI2015 选数</a></p>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2018/08/01/SCOI2015-选数/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-JLOI2015 战争调度">
    <header class="cube-excerpt-header">
        <h1><a href="/2018/08/01/JLOI2015-战争调度/">JLOI2015 战争调度</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2018-08-01
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/树形DP/" class="cube-excerpt-tag-link">#树形DP</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="题目描述"><a class="markdownIt-Anchor" href="#题目描述"></a> 题目描述:</h2>
<h3 id="脸哥最近来到了一个神奇的王国王国里的公民每个公民有两个下属或者没有下属这种关系刚好组成一个n层的完全二叉树-公民i的下属是2times-i-和2times-i1-最下层的公民即叶子节点的公民是平民平民没有下属最上层的是国王中间是各级贵族-现在这个王国爆发了战争国王需要决定每一个平民是去种地以供应粮食还是参加战争每一个贵族包括国王自己是去管理后勤还是领兵打仗-一个平民会对他的所有直系上司有贡献度若一个平民i参加战争他的某个直系上司j领兵打仗那么这个平民对上司的作战贡献度为w_ij-若一个平民i种地他的某个直系上司j管理后勤那么这个平民对上司的后勤贡献度为f_ij若-i-和-j-所参加的事务不同则没有贡献度-为了战争需要保障后勤国王还要求不多于-m-个平民参加战争-国王想要使整个王国所有贵族得到的贡献度最大并把这件事交给了脸哥-但不幸的是脸哥还有很多-deadline-没有完成他只能把这件事又转交给你-你能帮他安排吗我能不帮他安排吗"><a class="markdownIt-Anchor" href="#脸哥最近来到了一个神奇的王国王国里的公民每个公民有两个下属或者没有下属这种关系刚好组成一个n层的完全二叉树-公民i的下属是2times-i-和2times-i1-最下层的公民即叶子节点的公民是平民平民没有下属最上层的是国王中间是各级贵族-现在这个王国爆发了战争国王需要决定每一个平民是去种地以供应粮食还是参加战争每一个贵族包括国王自己是去管理后勤还是领兵打仗-一个平民会对他的所有直系上司有贡献度若一个平民i参加战争他的某个直系上司j领兵打仗那么这个平民对上司的作战贡献度为w_ij-若一个平民i种地他的某个直系上司j管理后勤那么这个平民对上司的后勤贡献度为f_ij若-i-和-j-所参加的事务不同则没有贡献度-为了战争需要保障后勤国王还要求不多于-m-个平民参加战争-国王想要使整个王国所有贵族得到的贡献度最大并把这件事交给了脸哥-但不幸的是脸哥还有很多-deadline-没有完成他只能把这件事又转交给你-你能帮他安排吗我能不帮他安排吗"></a>     脸哥最近来到了一个神奇的王国，王国里的公民每个公民有两个下属或者没有下属，这种关系刚好组成一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span>层的完全二叉树。公民<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>的下属是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mo>×</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">2\times i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span><span class="mbin">×</span><span class="mord mathit">i</span></span></span></span> 和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mo>×</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2\times i+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span><span class="mbin">×</span><span class="mord mathit">i</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span>。最下层的公民即叶子节点的公民是平民，平民没有下属，最上层的是国王，中间是各级贵族。现在这个王国爆发了战争，国王需要决定每一个平民是去种地以供应粮食还是参加战争，每一个贵族（包括国王自己）是去管理后勤还是领兵打仗。一个平民会对他的所有直系上司有贡献度，若一个平民<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>参加战争，他的某个直系上司<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>领兵打仗，那么这个平民对上司的作战贡献度为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>。若一个平民<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>种地，他的某个直系上司<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>管理后勤，那么这个平民对上司的后勤贡献度为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>，若 i 和 j 所参加的事务不同，则没有贡献度。为了战争需要保障后勤，国王还要求不多于 m 个平民参加战争。国王想要使整个王国所有贵族得到的贡献度最大，并把这件事交给了脸哥。但不幸的是，脸哥还有很多 deadline 没有完成，他只能把这件事又转交给你。你能帮他安排吗？(我能不帮他安排吗？)</h3>
<pre class="highlight"><code class="cpp">#include&lt;iostream&gt;
#include&lt;stdio.h&gt;
#include&lt;string.h&gt; 
#define N 1200
using namespace std;
int n,w[N][12],v[N][12],f[N][N],p[12];
int dfs(int x,int d){
    int i,j;
    for(i=0;i&lt;=1&lt;&lt;d;i++)f[x][i]=0;
    if(!d){
        for(i=1;i&lt;=n;i++){
            if(p[i])f[x][1]+=w[x][i];
            else f[x][0]+=v[x][i];
        }
        return 0;
    }
    p[d]=0,dfs(x&lt;&lt;1,d-1),dfs(x&lt;&lt;1|1,d-1);
    for(i=0;i&lt;=1&lt;&lt;(d-1);i++)
        for(j=0;j&lt;=1&lt;&lt;(d-1);j++)
            f[x][i+j]=max(f[x][i+j],f[x&lt;&lt;1][i]+f[x&lt;&lt;1|1][j]);
    p[d]=1,dfs(x&lt;&lt;1,d-1),dfs(x&lt;&lt;1|1,d-1);
    for(i=0;i&lt;=1&lt;&lt;(d-1);i++)
        for(j=0;j&lt;=1&lt;&lt;(d-1);j++)
            f[x][i+j]=max(f[x][i+j],f[x&lt;&lt;1][i]+f[x&lt;&lt;1|1][j]);
}
int main(){
    int m,ans=0;
    scanf(&quot;%d%d&quot;,&amp;n,&amp;m),n--;
    for(int i=0;i&lt;(1&lt;&lt;n);i++)for(int j=1;j&lt;=n;j++)scanf(&quot;%d&quot;,&amp;w[i+(1&lt;&lt;n)][j]);
    for(int i=0;i&lt;(1&lt;&lt;n);i++)for(int j=1;j&lt;=n;j++)scanf(&quot;%d&quot;,&amp;v[i+(1&lt;&lt;n)][j]);
    dfs(1,n);
    for(int i=0;i&lt;=m;i++)ans=max(ans,f[1][i]);
    printf(&quot;%d\n&quot;,ans);
}
</code></pre>
<p>题目链接:<a href="https://www.lydsy.com/JudgeOnline/problem.php?id=4007" target="_blank" rel="noopener">JLOI2015 战争调度</a></p>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2018/08/01/JLOI2015-战争调度/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-pyh的求和">
    <header class="cube-excerpt-header">
        <h1><a href="/2018/07/31/pyh的求和/">pyh的求和</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2018-07-31
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/好题/" class="cube-excerpt-tag-link">#好题</a>
                
                <a href="/tags/莫比乌斯反演/" class="cube-excerpt-tag-link">#莫比乌斯反演</a>
                
                <a href="/tags/分块/" class="cube-excerpt-tag-link">#分块</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="题目描述"><a class="markdownIt-Anchor" href="#题目描述"></a> 题目描述:</h2>
<h3 id="给出nm求"><a class="markdownIt-Anchor" href="#给出nm求"></a>     给出n,m，求:</h3>
<h2 id="sum_i1nlimitssum_j1m-limitsvarphiij"><a class="markdownIt-Anchor" href="#sum_i1nlimitssum_j1m-limitsvarphiij"></a>     <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mi>φ</mi><mo>(</mo><mi>i</mi><mi>j</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{n}\limits\sum_{j=1}^m \limits\varphi(ij)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.3513970000000004em;"></span><span class="strut bottom" style="height:2.465174em;vertical-align:-1.113777em;"></span><span class="base textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-0.9500050000000002em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-0.9500050000000002em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">m</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></h2>
<h3 id="总共求t组nmt都是105级别的数"><a class="markdownIt-Anchor" href="#总共求t组nmt都是105级别的数"></a>     总共求T组，n,m,t都是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">5</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>级别的数。</h3>
<h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解:</h2>
<h3 id="varphiijvarphiitimes-varphijtimes-fracdvarphiddgcdij"><a class="markdownIt-Anchor" href="#varphiijvarphiitimes-varphijtimes-fracdvarphiddgcdij"></a> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>φ</mi><mo>(</mo><mi>i</mi><mi>j</mi><mo>)</mo><mo>=</mo><mi>φ</mi><mo>(</mo><mi>i</mi><mo>)</mo><mo>×</mo><mi>φ</mi><mo>(</mo><mi>j</mi><mo>)</mo><mo>×</mo><mfrac><mrow><mi>d</mi></mrow><mrow><mi>φ</mi><mo>(</mo><mi>d</mi><mo>)</mo></mrow></mfrac><mo>(</mo><mi>d</mi><mo>=</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\varphi(ij)=\varphi(i)\times \varphi(j)\times \frac{d}{\varphi(d)}(d=gcd(i,j))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:1.400108em;vertical-align:-0.52em;"></span><span class="base textstyle uncramped"><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mbin">×</span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mbin">×</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">d</span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathit">d</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">c</span><span class="mord mathit">d</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></h3>
<h3 id="sum_i1nlimitssum_j1m-limitsvarphiij-2"><a class="markdownIt-Anchor" href="#sum_i1nlimitssum_j1m-limitsvarphiij-2"></a> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mi>φ</mi><mo>(</mo><mi>i</mi><mi>j</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{n}\limits\sum_{j=1}^m \limits\varphi(ij)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.3513970000000004em;"></span><span class="strut bottom" style="height:2.465174em;vertical-align:-1.113777em;"></span><span class="base textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-0.9500050000000002em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-0.9500050000000002em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">m</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></h3>
<h3 id="sum_i1nlimitssum_j1m-limitsvarphiivarphij-fracdvarphid"><a class="markdownIt-Anchor" href="#sum_i1nlimitssum_j1m-limitsvarphiivarphij-fracdvarphid"></a> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mi>φ</mi><mo>(</mo><mi>i</mi><mo>)</mo><mi>φ</mi><mo>(</mo><mi>j</mi><mo>)</mo><mfrac><mrow><mi>d</mi></mrow><mrow><mi>φ</mi><mo>(</mo><mi>d</mi><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">=\sum_{i=1}^{n}\limits\sum_{j=1}^m \limits\varphi(i)\varphi(j) \frac{d}{\varphi(d)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.3513970000000004em;"></span><span class="strut bottom" style="height:2.465174em;vertical-align:-1.113777em;"></span><span class="base textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-0.9500050000000002em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-0.9500050000000002em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">m</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">d</span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></h3>
<h3 id="sum_d1nlimits-fracdvarphidsum_i1lfloor-fracndrfloorlimits-sum_j1lfloorfracm-drfloorlimits-varphiidvarphijdgcdij1"><a class="markdownIt-Anchor" href="#sum_d1nlimits-fracdvarphidsum_i1lfloor-fracndrfloorlimits-sum_j1lfloorfracm-drfloorlimits-varphiidvarphijdgcdij1"></a> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mfrac><mrow><mi>d</mi></mrow><mrow><mi>φ</mi><mo>(</mo><mi>d</mi><mo>)</mo></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo>⌊</mo><mfrac><mrow><mi>n</mi></mrow><mi>d</mi></mfrac><mrow></mrow><mo>⌋</mo></mrow></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo>⌊</mo><mfrac><mrow><mi>m</mi></mrow><mrow><mi>d</mi></mrow></mfrac><mo>⌋</mo></mrow></msubsup><mi>φ</mi><mo>(</mo><mi>i</mi><mi>d</mi><mo>)</mo><mi>φ</mi><mo>(</mo><mi>j</mi><mi>d</mi><mo>)</mo><mo>[</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo><mo>=</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">=\sum_{d=1}^n\limits \frac{d}{\varphi(d)}\sum_{i=1}^{\lfloor \frac{n}d{}\rfloor}\limits \sum_{j=1}^{\lfloor\frac{m} {d}\rfloor}\limits \varphi(id)\varphi(jd)[gcd(i,j)=1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.727505em;"></span><span class="strut bottom" style="height:2.841282em;vertical-align:-1.113777em;"></span><span class="base textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:0.902113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">d</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.0000049999999998662226em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-0.950005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">d</span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-1.102505em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">⌊</span><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">d</span></span></span><span style="top:-0.22142857142857142em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span><span class="mord scriptstyle uncramped"></span><span class="mclose">⌋</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-1.102505em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">⌊</span><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">d</span></span></span></span><span style="top:-0.22142857142857142em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mord mathit">d</span><span class="mclose">)</span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mord mathit">d</span><span class="mclose">)</span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">c</span><span class="mord mathit">d</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mclose">]</span></span></span></span></h3>
<h3 id="sum_d1nlimits-fracdvarphidsum_i1lfloor-fracndrfloorlimits-sum_j1lfloorfracm-drfloorlimits-varphiidvarphijdsum_kikjlimits-muk"><a class="markdownIt-Anchor" href="#sum_d1nlimits-fracdvarphidsum_i1lfloor-fracndrfloorlimits-sum_j1lfloorfracm-drfloorlimits-varphiidvarphijdsum_kikjlimits-muk"></a> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mfrac><mrow><mi>d</mi></mrow><mrow><mi>φ</mi><mo>(</mo><mi>d</mi><mo>)</mo></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo>⌊</mo><mfrac><mrow><mi>n</mi></mrow><mi>d</mi></mfrac><mrow></mrow><mo>⌋</mo></mrow></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo>⌊</mo><mfrac><mrow><mi>m</mi></mrow><mrow><mi>d</mi></mrow></mfrac><mo>⌋</mo></mrow></msubsup><mi>φ</mi><mo>(</mo><mi>i</mi><mi>d</mi><mo>)</mo><mi>φ</mi><mo>(</mo><mi>j</mi><mi>d</mi><mo>)</mo><msub><mo>∑</mo><mrow><mi>k</mi><mi mathvariant="normal">∣</mi><mi>i</mi><mo separator="true">,</mo><mi>k</mi><mi mathvariant="normal">∣</mi><mi>j</mi></mrow></msub><mi>μ</mi><mo>(</mo><mi>k</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">=\sum_{d=1}^n\limits \frac{d}{\varphi(d)}\sum_{i=1}^{\lfloor \frac{n}d{}\rfloor}\limits \sum_{j=1}^{\lfloor\frac{m} {d}\rfloor}\limits \varphi(id)\varphi(jd)\sum_{k|i,k|j}\limits \mu(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.727505em;"></span><span class="strut bottom" style="height:2.94351em;vertical-align:-1.216005em;"></span><span class="base textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:0.902113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">d</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.0000049999999998662226em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-0.950005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">d</span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-1.102505em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">⌊</span><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">d</span></span></span><span style="top:-0.22142857142857142em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span><span class="mord scriptstyle uncramped"></span><span class="mclose">⌋</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-1.102505em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">⌊</span><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">d</span></span></span></span><span style="top:-0.22142857142857142em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mord mathit">d</span><span class="mclose">)</span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mord mathit">d</span><span class="mclose">)</span><span class="mop op-limits"><span class="vlist"><span style="top:0.9410049999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathrm">∣</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">μ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></h3>
<h3 id="sum_k1nlimitsmuksum_d1lfloor-fracndrfloorlimits-fracdvarphidsum_i1lfloor-fracndkrfloorlimits-sum_j1lfloorfracm-dkrfloorlimits-varphiikdvarphijkd枚举k"><a class="markdownIt-Anchor" href="#sum_k1nlimitsmuksum_d1lfloor-fracndrfloorlimits-fracdvarphidsum_i1lfloor-fracndkrfloorlimits-sum_j1lfloorfracm-dkrfloorlimits-varphiikdvarphijkd枚举k"></a> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><mi>μ</mi><mo>(</mo><mi>k</mi><mo>)</mo><msubsup><mo>∑</mo><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo>⌊</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mi>d</mi></mrow></mfrac><mo>⌋</mo></mrow></msubsup><mfrac><mrow><mi>d</mi></mrow><mrow><mi>φ</mi><mo>(</mo><mi>d</mi><mo>)</mo></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo>⌊</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mi>d</mi><mi>k</mi></mrow></mfrac><mo>⌋</mo></mrow></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo>⌊</mo><mfrac><mrow><mi>m</mi></mrow><mrow><mi>d</mi><mi>k</mi></mrow></mfrac><mo>⌋</mo></mrow></msubsup><mi>φ</mi><mo>(</mo><mi>i</mi><mi>k</mi><mi>d</mi><mo>)</mo><mi>φ</mi><mo>(</mo><mi>j</mi><mi>k</mi><mi>d</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">=\sum_{k=1}^{n}\limits\mu(k)\sum_{d=1}^{\lfloor \frac{n}{d}\rfloor}\limits \frac{d}{\varphi(d)}\sum_{i=1}^{\lfloor \frac{n}{dk}\rfloor}\limits \sum_{j=1}^{\lfloor\frac{m} {dk}\rfloor}\limits \varphi(ikd)\varphi(jkd)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.727505em;"></span><span class="strut bottom" style="height:2.841282em;vertical-align:-1.113777em;"></span><span class="base textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:0.902113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.0000049999999998662226em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-0.950005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">μ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mop op-limits"><span class="vlist"><span style="top:0.902113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">d</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.0000049999999998662226em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-1.1025049999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">⌊</span><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">d</span></span></span></span><span style="top:-0.22142857142857142em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">d</span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-1.102505em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">⌊</span><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-0.22142857142857142em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-1.102505em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">⌊</span><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-0.22142857142857142em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit">d</span><span class="mclose">)</span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit">d</span><span class="mclose">)</span></span></span></span>(枚举k)</h3>
<h3 id="sum_c1nlimitssum_dclimits-mufraccdfracdvarphidsum_i1lfloor-fracncrfloorlimits-sum_j1lfloorfracm-crfloorlimits-varphiicvarphijc枚举ckd记"><a class="markdownIt-Anchor" href="#sum_c1nlimitssum_dclimits-mufraccdfracdvarphidsum_i1lfloor-fracncrfloorlimits-sum_j1lfloorfracm-crfloorlimits-varphiicvarphijc枚举ckd记"></a> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><msub><mo>∑</mo><mrow><mi>d</mi><mi mathvariant="normal">∣</mi><mi>c</mi></mrow></msub><mi>μ</mi><mo>(</mo><mfrac><mrow><mi>c</mi></mrow><mrow><mi>d</mi></mrow></mfrac><mo>)</mo><mfrac><mrow><mi>d</mi></mrow><mrow><mi>φ</mi><mo>(</mo><mi>d</mi><mo>)</mo></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo>⌊</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mi>c</mi></mrow></mfrac><mo>⌋</mo></mrow></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo>⌊</mo><mfrac><mrow><mi>m</mi></mrow><mrow><mi>c</mi></mrow></mfrac><mo>⌋</mo></mrow></msubsup><mi>φ</mi><mo>(</mo><mi>i</mi><mi>c</mi><mo>)</mo><mi>φ</mi><mo>(</mo><mi>j</mi><mi>c</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">=\sum_{c=1}^{n}\limits\sum_{d|c}\limits \mu(\frac{c}{d})\frac{d}{\varphi(d)}\sum_{i=1}^{\lfloor \frac{n}{c}\rfloor}\limits \sum_{j=1}^{\lfloor\frac{m} {c}\rfloor}\limits \varphi(ic)\varphi(jc)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.727505em;"></span><span class="strut bottom" style="height:2.94351em;vertical-align:-1.216005em;"></span><span class="base textstyle uncramped"><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:0.8671129999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-0.9500050000000002em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:0.9410049999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">d</span><span class="mord mathrm">∣</span><span class="mord mathit">c</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">μ</span><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">d</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">)</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">d</span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-1.102505em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">⌊</span><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">c</span></span></span></span><span style="top:-0.22142857142857142em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-1.102505em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">⌊</span><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">c</span></span></span></span><span style="top:-0.22142857142857142em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span>（枚举c=kd）记</h3>
<h3 id="记fnsum_dnlimits-mufracndfracdvarphid"><a class="markdownIt-Anchor" href="#记fnsum_dnlimits-mufracndfracdvarphid"></a> 记<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>n</mi><mo>)</mo><mo>=</mo><msub><mo>∑</mo><mrow><mi>d</mi><mi mathvariant="normal">∣</mi><mi>n</mi></mrow></msub><mi>μ</mi><mo>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mi>d</mi></mrow></mfrac><mo>)</mo><mfrac><mrow><mi>d</mi></mrow><mrow><mi>φ</mi><mo>(</mo><mi>d</mi><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">f(n)=\sum_{d|n}\limits \mu(\frac{n}{d})\frac{d}{\varphi(d)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:2.096113em;vertical-align:-1.216005em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:0.9410049999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">d</span><span class="mord mathrm">∣</span><span class="mord mathit">n</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">μ</span><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">d</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">)</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">d</span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></h3>
<h3 id="sum_c1nfcsum_i1lfloor-fracncrfloorlimits-varphiicsum_j1lfloorfracm-crfloorlimits-varphijc"><a class="markdownIt-Anchor" href="#sum_c1nfcsum_i1lfloor-fracncrfloorlimits-varphiicsum_j1lfloorfracm-crfloorlimits-varphijc"></a> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><mi>f</mi><mo>(</mo><mi>c</mi><mo>)</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo>⌊</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mi>c</mi></mrow></mfrac><mo>⌋</mo></mrow></msubsup><mi>φ</mi><mo>(</mo><mi>i</mi><mi>c</mi><mo>)</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo>⌊</mo><mfrac><mrow><mi>m</mi></mrow><mrow><mi>c</mi></mrow></mfrac><mo>⌋</mo></mrow></msubsup><mi>φ</mi><mo>(</mo><mi>j</mi><mi>c</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">=\sum_{c=1}^{n}f(c)\sum_{i=1}^{\lfloor \frac{n}{c}\rfloor}\limits \varphi(ic)\sum_{j=1}^{\lfloor\frac{m} {c}\rfloor}\limits \varphi(jc)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.727505em;"></span><span class="strut bottom" style="height:2.841282em;vertical-align:-1.113777em;"></span><span class="base textstyle uncramped"><span class="mrel">=</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-1.102505em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">⌊</span><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">c</span></span></span></span><span style="top:-0.22142857142857142em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mop op-limits"><span class="vlist"><span style="top:0.8776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-1.102505em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">⌊</span><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">c</span></span></span></span><span style="top:-0.22142857142857142em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span></h3>
<h3 id="记snk为sum_i1nvarphiik"><a class="markdownIt-Anchor" href="#记snk为sum_i1nvarphiik"></a> 记<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>(</mo><mi>n</mi><mo separator="true">,</mo><mi>k</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">S(n,k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span>为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>φ</mi><mo>(</mo><mi>i</mi><mi>k</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum_{i=1}^n\varphi(ik)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0500099999999999em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">φ</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></h3>
<h3 id="sum_c1nfcslfloor-fracncrfloorcslfloor-fracmcrfloorc"><a class="markdownIt-Anchor" href="#sum_c1nfcslfloor-fracncrfloorcslfloor-fracmcrfloorc"></a> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>f</mi><mo>(</mo><mi>c</mi><mo>)</mo><mi>S</mi><mo>(</mo><mo>⌊</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mi>c</mi></mrow></mfrac><mo>⌋</mo><mo separator="true">,</mo><mi>c</mi><mo>)</mo><mi>S</mi><mo>(</mo><mo>⌊</mo><mfrac><mrow><mi>m</mi></mrow><mrow><mi>c</mi></mrow></mfrac><mo>⌋</mo><mo separator="true">,</mo><mi>c</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">=\sum_{c=1}^nf(c)S(\lfloor \frac{n}{c}\rfloor,c)S(\lfloor \frac{m}{c}\rfloor,c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.095em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mrel">=</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mopen">⌊</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span><span class="mpunct">,</span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mopen">⌊</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span><span class="mpunct">,</span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span></h3>
<h3 id="fc和sxc都可以利用调和级数预处理出来"><a class="markdownIt-Anchor" href="#fc和sxc都可以利用调和级数预处理出来"></a>     <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>c</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f(c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>c</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">S(x,c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span>都可以利用调和级数预处理出来。</h3>
<h3 id="但是我们每次不能on求考虑对原式进行分块"><a class="markdownIt-Anchor" href="#但是我们每次不能on求考虑对原式进行分块"></a>     但是我们每次不能O(n)求，考虑对原式进行分块。</h3>
<h3 id="我们预处理一个tijksum_x1klimits-sixsjxi和j至于处理到35"><a class="markdownIt-Anchor" href="#我们预处理一个tijksum_x1klimits-sixsjxi和j至于处理到35"></a>    我们预处理一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi><mo>)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mi>S</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>x</mi><mo>)</mo><mo>∗</mo><mi>S</mi><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">T(i,j,k)=\sum_{x=1}^k\limits S(i,x)*S(j,x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.5361130000000003em;"></span><span class="strut bottom" style="height:2.503226em;vertical-align:-0.9671129999999999em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:0.8671129999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">x</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000088267em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol small-op mop">∑</span></span></span><span style="top:-0.9500050000000002em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mbin">∗</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>（i和j至于处理到35）</h3>
<h3 id="当clfloor-fracn35rfloor时直接暴力累加"><a class="markdownIt-Anchor" href="#当clfloor-fracn35rfloor时直接暴力累加"></a>     当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mo>&lt;</mo><mo>=</mo><mo>⌊</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>3</mn><mn>5</mn></mrow></mfrac><mo>⌋</mo></mrow><annotation encoding="application/x-tex">c&lt;=\lfloor \frac{n}{35}\rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.095em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord mathit">c</span><span class="mrel">&lt;</span><span class="mrel">=</span><span class="mopen">⌊</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">3</span><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span>时直接暴力累加。</h3>
<h3 id="当clfloorfracn35rfloor时原式中s的第一个系数都小于35那就可以用tijk数论分块叠加上去-至于为什么是35调参调出来的"><a class="markdownIt-Anchor" href="#当clfloorfracn35rfloor时原式中s的第一个系数都小于35那就可以用tijk数论分块叠加上去-至于为什么是35调参调出来的"></a>     当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mo>&gt;</mo><mo>⌊</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>3</mn><mn>5</mn></mrow></mfrac><mo>⌋</mo></mrow><annotation encoding="application/x-tex">c&gt;\lfloor\frac{n}{35}\rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.095em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord mathit">c</span><span class="mrel">&gt;</span><span class="mopen">⌊</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">3</span><span class="mord mathrm">5</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span>时,原式中S的第一个系数都小于35，那就可以用T(i,j,k)数论分块叠加上去。（至于为什么是35，调参调出来的）。</h3>
<pre class="highlight"><code class="cpp">#include&lt;iostream&gt;
#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
#define P 998244353
#define N 120000
#define K 35
using namespace std;
int prime[N],phi[N],p[N],h[N],mu[N];
long long a[N*120],b[N*60],tot,cnt,inv[N],f[N];
int pre(){
    mu[1]=1;
    phi[1]=1;
    for(int i=2;i&lt;N-10;i++){
        if(p[i]==0){
            prime[++tot]=i;
            phi[i]=i-1;
            mu[i]=-1;
        }
        for(int j=1;j&lt;=tot&amp;&amp;i*prime[j]&lt;N-10;j++){
            p[i*prime[j]]=1;
            phi[i*prime[j]]=phi[i]*phi[prime[j]];
            mu[i*prime[j]]=-mu[i];
            if(i%prime[j]==0){
                mu[i*prime[j]]=0;
                phi[i*prime[j]]=phi[i]*prime[j];
                break;
            }
        }
    }
}
long long power(long long x,int k){
    long long ans=1;
    while(k){
        if(k&amp;1)(ans*=x)%=P;
        (x*=x)%=P;
        k&gt;&gt;=1;
    }
    return ans;
}
long long T(int x,int y,int j){
    int i=(x*(K+1)+y);
    return b[p[i]+j];
}
long long G(int i,int j){
    if(h[i]+j&gt;=h[i+1])return 0;
    return a[h[i]+j];
}
int ppre(){
    int n=100000;
    for(int i=1;i&lt;=n;i++)inv[i]=power(i,P-2);
    memset(p,0,sizeof(p));
    for(int i=1;i&lt;=n;i++)
        for(int j=i;j&lt;=n;j+=i)
            f[j]=(f[j]+1LL*mu[j/i]*i*inv[phi[i]]%P+P)%P;
    for(int i=1;i&lt;=n;i++){
        tot++;
        h[i]=tot;
        for(int j=1;j&lt;=n/i;j++)a[++tot]=(a[tot-1]+phi[i*j])%P;
    }
    cnt=0;
    long long pp=0;
    for(int j=1;j&lt;=K;j++)
        for(int k=j;k&lt;=K;k++){
            int o=j*(K+1)+k;
            p[o]=++cnt;
            b[cnt]=0;
            int len=n/max(j,k);
            pp+=len;
            for(int i=1;i&lt;=len;i++){
                cnt++;
                b[cnt]=(b[cnt-1]+1LL*f[i]*G(i,j)%P*G(i,k)%P)%P;
            }
        }
}
long long solve(int n,int m){
    if(n&gt;m)swap(n,m);
    long long ans=0;
    for(int i=1;i&lt;=m/K;i++)ans=(ans+1LL*f[i]*G(i,n/i)%P*G(i,m/i)%P)%P;
    for(int i=m/K+1;i&lt;=n;i++){
        int j=min(n/(n/i),m/(m/i));
        ans=(ans+T(n/i,m/i,j)-T(n/i,m/i,i-1)+P)%P;
        i=j;
    }
    return ans;
}
int main(){
    pre();
    tot=0;
    ppre();
    int t;
    scanf(&quot;%d&quot;,&amp;t);
    while(t--){
        int n,m;
        scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
        printf(&quot;%lld\n&quot;,solve(n,m));
    }
} 
</code></pre>
<p>题目链接：<a href="https://loj.ac/problem/6179" target="_blank" rel="noopener"> Pyh的求和</a></p>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2018/07/31/pyh的求和/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-抵制克苏恩">
    <header class="cube-excerpt-header">
        <h1><a href="/2018/07/31/抵制克苏恩/">抵制克苏恩</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2018-07-31
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/概率与期望/" class="cube-excerpt-tag-link">#概率与期望</a>
                
                <a href="/tags/记忆化搜索/" class="cube-excerpt-tag-link">#记忆化搜索</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="题目描述"><a class="markdownIt-Anchor" href="#题目描述"></a> 题目描述：</h2>
<h3 id="小q同学现在沉迷炉石传说不能自拔-他发现一张名为克苏恩的牌很不公平-如果你不玩炉石传说不必担心小q同学会告诉你所有相关的细节-炉石传说是这样的一个游戏每个玩家拥有一个-30-点血量的英雄并且可以用牌召唤至多-7-个随从帮助玩家攻击对手其中每个随从也拥有自己的血量和攻击力-小q同学有很多次游戏失败都是因为对手使用了克苏恩这张牌所以他想找到一些方法来抵御克苏恩-他去求助职业炉石传说玩家椎名真白真白告诉他使用奴隶主这张牌就可以啦-如果你不明白我上面在说什么不必担心小q同学会告诉你他想让你做什么"><a class="markdownIt-Anchor" href="#小q同学现在沉迷炉石传说不能自拔-他发现一张名为克苏恩的牌很不公平-如果你不玩炉石传说不必担心小q同学会告诉你所有相关的细节-炉石传说是这样的一个游戏每个玩家拥有一个-30-点血量的英雄并且可以用牌召唤至多-7-个随从帮助玩家攻击对手其中每个随从也拥有自己的血量和攻击力-小q同学有很多次游戏失败都是因为对手使用了克苏恩这张牌所以他想找到一些方法来抵御克苏恩-他去求助职业炉石传说玩家椎名真白真白告诉他使用奴隶主这张牌就可以啦-如果你不明白我上面在说什么不必担心小q同学会告诉你他想让你做什么"></a>     小Q同学现在沉迷炉石传说不能自拔。他发现一张名为克苏恩的牌很不公平。如果你不玩炉石传说，不必担心，小Q同学会告诉你所有相关的细节。炉石传说是这样的一个游戏，每个玩家拥有一个 30 点血量的英雄，并且可以用牌召唤至多 7 个随从帮助玩家攻击对手，其中每个随从也拥有自己的血量和攻击力。小Q同学有很多次游戏失败都是因为对手使用了克苏恩这张牌，所以他想找到一些方法来抵御克苏恩。他去求助职业炉石传说玩家椎名真白，真白告诉他使用奴隶主这张牌就可以啦。如果你不明白我上面在说什么，不必担心，小Q同学会告诉你他想让你做什么。</h3>
<h3 id="现在小q同学会给出克苏恩的攻击力是-k-表示克苏恩会攻击-k-次每次会从对方场上的英雄和随从中随机选择一个并对其产生-1-点伤害-现在对方有一名克苏恩你有一些奴隶主作为随从每名奴隶主的血量是给定的-如果克苏恩攻击了你的一名奴隶主那么这名奴隶主的血量会减少-1-点当其血量小于等于-0-时会死亡如果受到攻击后不死亡并且你的随从数量没有达到-7-这名奴隶主会召唤一个拥有-3-点血量的新奴隶主作为你的随从如果克苏恩攻击了你的英雄你的英雄会记录受到-1-点伤害-你应该注意到了每当克苏恩进行一次攻击你场上的随从可能发生很大的变化-小q同学为你假设了克苏恩的攻击力你场上分别有-1-点-2-点-3-点血量的奴隶主数量你可以计算出你的英雄受到的总伤害的期望值是多少吗"><a class="markdownIt-Anchor" href="#现在小q同学会给出克苏恩的攻击力是-k-表示克苏恩会攻击-k-次每次会从对方场上的英雄和随从中随机选择一个并对其产生-1-点伤害-现在对方有一名克苏恩你有一些奴隶主作为随从每名奴隶主的血量是给定的-如果克苏恩攻击了你的一名奴隶主那么这名奴隶主的血量会减少-1-点当其血量小于等于-0-时会死亡如果受到攻击后不死亡并且你的随从数量没有达到-7-这名奴隶主会召唤一个拥有-3-点血量的新奴隶主作为你的随从如果克苏恩攻击了你的英雄你的英雄会记录受到-1-点伤害-你应该注意到了每当克苏恩进行一次攻击你场上的随从可能发生很大的变化-小q同学为你假设了克苏恩的攻击力你场上分别有-1-点-2-点-3-点血量的奴隶主数量你可以计算出你的英雄受到的总伤害的期望值是多少吗"></a>     现在小Q同学会给出克苏恩的攻击力是 K ，表示克苏恩会攻击 K 次，每次会从对方场上的英雄和随从中随机选择一个并对其产生 1 点伤害。现在对方有一名克苏恩，你有一些奴隶主作为随从，每名奴隶主的血量是给定的。如果克苏恩攻击了你的一名奴隶主，那么这名奴隶主的血量会减少 1 点，当其血量小于等于 0 时会死亡，如果受到攻击后不死亡，并且你的随从数量没有达到 7 ，这名奴隶主会召唤一个拥有 3 点血量的新奴隶主作为你的随从；如果克苏恩攻击了你的英雄，你的英雄会记录受到 1 点伤害。你应该注意到了，每当克苏恩进行一次攻击，你场上的随从可能发生很大的变化。小Q同学为你假设了克苏恩的攻击力，你场上分别有 1 点、 2 点、 3 点血量的奴隶主数量，你可以计算出你的英雄受到的总伤害的期望值是多少吗？</h3>
<h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解：</h2>
<h3 id="因为数据范围着实小所以直接列出方程记忆化搜索即可"><a class="markdownIt-Anchor" href="#因为数据范围着实小所以直接列出方程记忆化搜索即可"></a>     因为数据范围着实小，所以直接列出方程记忆化搜索即可。</h3>
<pre class="highlight"><code class="cpp">#include&lt;iostream&gt;
#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
using namespace std;
long double g[60][8][8][8];
long double f(int k,int a,int b,int c){
    long double ans=0;
    int o=1+a+b+c;
    if(g[k][a][b][c]&gt;0)return g[k][a][b][c];
    if(k==1)return 1.0/o;
    ans=1.0/o+1.0/o*f(k-1,a,b,c);
    if(a)ans+=(a+0.0)/o*f(k-1,a-1,b,c);
    if(b){
        if(a+b+c&lt;7)ans+=(b+0.0)/o*f(k-1,a+1,b-1,c+1);
        else ans+=(b+0.0)/o*f(k-1,a+1,b-1,c);
    }
    if(c){
        if(a+b+c&lt;7)ans+=(c+0.0)/o*f(k-1,a,b+1,c);
        else ans+=(c+0.0)/o*f(k-1,a,b+1,c-1);
    }
    g[k][a][b][c]=ans;
    return g[k][a][b][c];
}
int main(){
    int t;
    scanf(&quot;%d&quot;,&amp;t);
    while(t--){
        int k,a,b,c;
        scanf(&quot;%d%d%d%d&quot;,&amp;k,&amp;a,&amp;b,&amp;c);
        printf(&quot;%.2Lf\n&quot;,f(k,a,b,c));
    }
}

</code></pre>
<p>题目链接： <a href="https://www.lydsy.com/JudgeOnline/problem.php?id=4832" target="_blank" rel="noopener">Lydsy1704月赛 抵制克苏恩</a></p>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2018/07/31/抵制克苏恩/">Read More</a>
    </footer>
</div>



<ul class="cube-pagination cube-pagination-9">
    
    <li class="cube-pagination-prev disabled">
        <span>« Prev</span>
    </li>
    
    
        
            
                
                <li class="cube-pagination-index disabled">
                    <span>1</span>
                </li>
                
            
                
                <li class="cube-pagination-index">
                    <a href="/page/2">2</a>
                </li>
                
            
                
                <li class="cube-pagination-index">
                    <a href="/page/3">3</a>
                </li>
                
            
                
                <li class="cube-pagination-index">
                    <a href="/page/4">4</a>
                </li>
                
            
                <li class="cube-pagination-ellipses">
                    <span>...</span>
                </li>
                <li class="cube-pagination-index">
                    <a href="/page/7">7</a>
                </li>
        
    

    
    <li class="cube-pagination-next">
        <a href="/page/2/">Next »</a>
    </li>
    
</ul>

<!--其他组件后续添加-->
        </div>
        <div class="cube-right">
            

<div class="cube-search cube-sidebar" id="cube-search">
    <div class="search-container">
        <input type="text" placeholder="Search" class="cube-search-input" id="cube-search-input">
        <i class="cube-icon cube-icon-search cube-search-submit" aria-hidden="true"></i>
    </div>
    <!-- TODO 通过给window赋一个全局变量，通过脚本赋值 -->
</div>
<script>
    (function (window) {
        'use strict';
        window.searchModule = {}
        window.searchModule.JSONUrl = '/content.json'
        window.searchModule.rootUrl = '/'
    })(window)
</script>
<div class="cube-search-form">
    <div class="cube-search-control">
        <input type="text" placeholder="Search" class="search-input">
        <a class="close-button">
            <i class="cube-icon cube-close" aria-hidden="true"></i>
        </a>
    </div>
    <div class="cube-search-result"></div>
</div>


<div class="cube-author cube-sidebar" id="cube-author">
    
    
    <span>John Doe</span>
    
    
    <div class="count">
        <a class="count articles"><span>65</span>Article</a>
        <a class="count tags"><span>58</span>Tags</a>
        <a class="count categories"><span>2</span>Categories</a>
    </div>
</div>



<div class="cube-music cube-sidebar" id="cube-music">
    <div class="cube-player aplayer" id="cube-player"></div>
</div>
<script>
    (function (window) {
        window.musicModule = {}
        window.musicModule.musicConfig = '{"narrow":false,"autoplay":false,"showlrc":3,"theme":"#b7daff","mutex":true,"mode":"circulation","preload":"auto","listmaxheight":"513px","music":[{"title":"彼方 - 星尘","author":"乌龟sui","url":"https://yyxxqq.github.io/music/%E6%98%9F%E5%B0%98%20-%20%E3%80%90%E6%98%9F%E5%B0%98%E3%80%91%E5%BD%BC%E6%96%B9.mp3","lrc":"https://yyxxqq.github.io/music/%E3%80%90%E6%98%9F%E5%B0%98%E3%80%91%E5%BD%BC%E6%96%B9-%E6%98%9F%E5%B0%98.lrc","pic":"http://yoursite.com/images/music/undefined"},{"title":"fhána - ワンダーステラ","author":"fhána","url":"https://yyxxqq.github.io/music/fh%C3%A1na%20-%20%E3%83%AF%E3%83%B3%E3%83%80%E3%83%BC%E3%82%B9%E3%83%86%E3%83%A9.mp3","pic":"http://yoursite.com/images/music/undefined"},{"title":"中島美嘉 - 僕が死のうと思ったのは","author":"中島美嘉","url":"https://yyxxqq.github.io/music/%E4%B8%AD%E5%B3%B6%E7%BE%8E%E5%98%89%20-%20%E5%83%95%E3%81%8C%E6%AD%BB%E3%81%AE%E3%81%86%E3%81%A8%E6%80%9D%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%AF.mp3","lrc":"https://yyxxqq.github.io/music/%E5%83%95%E3%81%8C%E6%AD%BB%E3%81%AE%E3%81%86%E3%81%A8%E6%80%9D%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%AF-%E4%B8%AD%E5%B3%B6%E7%BE%8E%E5%98%89.lrc","pic":"http://yoursite.com/images/music/undefined"}]}'
        window.musicModule.lrcConfig = {
            open: 'Open Lyrics',
            close: 'Close Lyrics'
        }
    })(window)
</script>



<div class="cube-recent-posts cube-sidebar" id="cube-recent-posts">
    <div class="title">
        <a>Recent Posts</a>
    </div>
    <ul class="list">
        
        
        <li>
            <!-- TODO 如果文章要显示图片，那么在front-matter上添加preview属性(url or path) -->
            
            <div class="normal">
                <p class="index first">
                    <span>1</span>
                </p>
                <p class="title">
                    <a href="/2018/10/07/「雅礼集训-2017-Day2」线段游戏/" title="「雅礼集训 2017 Day2」线段游戏">「雅礼集训 2017 Day2」线段游戏</a>
                </p>
            </div>
            
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>2</span>
                </p>
                <p class="title">
                    <a href="/2018/10/07/K相等/" title="K相等">K相等</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>3</span>
                </p>
                <p class="title">
                    <a href="/2018/10/05/Illyasviel的图游戏/" title="Illyasviel的图游戏">Illyasviel的图游戏</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>4</span>
                </p>
                <p class="title">
                    <a href="/2018/10/05/复活-1/" title="复活">复活</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>5</span>
                </p>
                <p class="title">
                    <a href="/2018/08/01/暑假计划/" title="2018暑假计划">2018暑假计划</a>
                </p>
            </div>
        </li>
        
        
    </ul>
</div>



<div class="cube-categories cube-sidebar" id="cube-categories">
    <div class="title">
        <a href="/categories">Categories</a>
    </div>
    <div class="cube-boxs">
        
        
        <div class="cube-box ">
            <a href="/categories/OI/">#OI</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/人生/">#人生</a>
        </div>
        
    </div>
</div>



<div class="cube-tagcloud cube-sidebar" id="cube-tagcloud">
    <div class="title">
        <a href="/tags">Tagcloud</a>
    </div>
    <div class="cube-boxs">
        
        
        <div class="cube-box ">
            <a href="/tags/好题/">#好题</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/博弈论/">#博弈论</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/BZOJ/">#BZOJ</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/分数规划/">#分数规划</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/树链剖分/">#树链剖分</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/凸包/">#凸包</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/倍增/">#倍增</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/后缀自动机/">#后缀自动机</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/高斯消元/">#高斯消元</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/NOIP模拟题/">#NOIP模拟题</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/矩阵快速幂/">#矩阵快速幂</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/特征方程/">#特征方程</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/线性基/">#线性基</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/树形DP/">#树形DP</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/人类智慧/">#人类智慧</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/NOI/">#NOI</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/状压DP/">#状压DP</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/最小表示法/">#最小表示法</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/hash/">#hash</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/二分/">#二分</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/组合数学/">#组合数学</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/计数/">#计数</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/斜率优化/">#斜率优化</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/CDQ分治/">#CDQ分治</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/线段树/">#线段树</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/KMP/">#KMP</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/卡常/">#卡常</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/SPFA/">#SPFA</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/点分治/">#点分治</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/模拟/">#模拟</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/贪心/">#贪心</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/中国剩余定理/">#中国剩余定理</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/可持久化并查集/">#可持久化并查集</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/莫比乌斯反演/">#莫比乌斯反演</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/杜教筛/">#杜教筛</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/可持久化线段树/">#可持久化线段树</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/广义后缀自动机/">#广义后缀自动机</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/分块/">#分块</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/构造/">#构造</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/费用流/">#费用流</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/哈希/">#哈希</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/期望/">#期望</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/概率与期望/">#概率与期望</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/记忆化搜索/">#记忆化搜索</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/数学/">#数学</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/dp优化/">#dp优化</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/计划表/">#计划表</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/最小生成树/">#最小生成树</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/概率/">#概率</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/上下界网络流/">#上下界网络流</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/splay/">#splay</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/AC自动机/">#AC自动机</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/后缀数组/">#后缀数组</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/整体二分/">#整体二分</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/FFT/">#FFT</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/树状数组/">#树状数组</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/搜索/">#搜索</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/积性函数/">#积性函数</a>
        </div>
        
    </div>
</div>



<div class="cube-links cube-sidebar" id="cube-links">
    <div class="title">
        <a>Links</a>
    </div>
    <ul class="list">
        
        <li>
            
            <a href="" target="_blank">yxq的QQ:1922610598</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/GitHub.png">
            
            <a href="https://www.bilibili.com/bangumi/media/md2575" target="_blank">伊莉雅天下第一可爱！</a>
        </li>
        
    </ul>
</div>



<div class="cube-friend-links cube-sidebar" id="cube-friend-links">
    <div class="title">
        <a>Friend Links</a>
    </div>
    <ul class="list">
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="https://yyxxqq.github.io/picture/ypl.jpg">
            <a href="http://sdchr.github.io" target="_blank">杨沛霖</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="https://yyxxqq.github.io/picture/zjt.jpg">
            <a href="http://101.236.55.78/" target="_blank">郑钧天</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="https://yyxxqq.github.io/picture/yww.jpg">
            <a href="http://www.cnblogs.com/ywwyww" target="_blank">袁无为</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="https://yyxxqq.github.io/picture/xfz.jpg">
            <a href="http://www.cnblogs.com/xiefengze1" target="_blank">谢丰泽</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="https://yyxxqq.github.io/picture/hy.jpg">
            <a href="http://www.cnblogs.com/yoyoball" target="_blank">洪云</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="https://yyxxqq.github.io/picture/lyy.jpg">
            <a href="http://www.cnblogs.com/jefflyy/" target="_blank">梁蕴誉</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="https://yyxxqq.github.io/picture/wzt.jpg">
            <a href="https://www.wangzhongtao.com/" target="_blank">王忠涛</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="https://yyxxqq.github.io/picture/hwc.jpg">
            <a href="https://www.ebola.pro/" target="_blank">黄文翀</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="https://raw.githubusercontent.com/yyxxqq/yyxxqq.github.io/master/picture/gzb.jpg">
            <a href="http://blog.csdn.net/qq_36993218" target="_blank">高泽斌</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="https://raw.githubusercontent.com/yyxxqq/yyxxqq.github.io/master/picture/xzy.jpg">
            <a href="https://www.cnblogs.com/Cmd2001" target="_blank">邢泽宇</a>
        </li>
        
    </ul>
</div>


        </div>
    </div>
</div>
<footer class="cube-footer">
    
© 2017 John Doe

<br>
Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>.&nbsp;Theme by <a href="https://github.com/ZEROKISEKI" target="_blank">AONOSORA</a>
</footer>
<!-- inject:script -->
<script src="/js/script.js"></script>
<!-- endinject -->
<div class="cube-loading out"></div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>